---
name: "Feature Development - Focused Scope"
description: "Optimize context for adding subscription billing feature"
skill: context-optimizer
priority: P1
estimated_time: "1-2 minutes"

input:
  prompt: "Add subscription billing with monthly/annual plans to payment module"

  loaded_context:
    total_tokens: 45000
    specs:
      - name: "auth-spec.md"
        tokens: 12000
        domain: "auth"

      - name: "payment-spec.md"
        tokens: 9000
        domain: "payment"

      - name: "user-management-spec.md"
        tokens: 7000
        domain: "users"

    docs:
      - name: "architecture/payment-integration.md"
        tokens: 6000
        domain: "payment"

      - name: "architecture/auth-design.md"
        tokens: 5000
        domain: "auth"

      - name: "architecture/adr/0015-payment-provider.md"
        tokens: 3000
        domain: "payment"

    agents:
      - name: "pm-agent"
        tokens: 2000

      - name: "nodejs-backend"
        tokens: 8000

      - name: "tech-lead-agent"
        tokens: 2000

expected_output:
  task_analysis:
    task_type: "feature"
    domains: ["payment", "backend"]
    scope: "focused"
    needs_full_context: false
    confidence: 0.90-0.95

  optimization_result:
    tokens_before: 45000
    tokens_after: 28000-32000
    reduction_percentage: 29-38
    total_reduction: 79-81  # From original 150k

  removed_sections:
    specs:
      - "auth-spec.md (12000 tokens) - Unrelated to payment feature"
      - "user-management-spec.md (7000 tokens) - Not involved in billing"

    docs:
      - "architecture/auth-design.md (5000 tokens) - Different domain"

  kept_sections:
    specs:
      - "payment-spec.md (9000 tokens) - Core domain"

    docs:
      - "architecture/payment-integration.md (6000 tokens) - Integration context"
      - "architecture/adr/0015-payment-provider.md (3000 tokens) - Provider decisions"

    agents:
      - "pm-agent (2000 tokens) - Requirements clarification"
      - "nodejs-backend (8000 tokens) - Implementation"
      - "tech-lead-agent (2000 tokens) - Planning and review"

  rationale:
    - "Feature development in payment domain only"
    - "PM agent kept for requirements refinement"
    - "Tech Lead kept for planning and architecture"
    - "Payment integration docs provide integration points"
    - "ADR provides context on payment provider choice"

validation:
  - "Task type detected as 'feature'"
  - "Domains detected: payment, backend"
  - "Scope: focused"
  - "Token reduction >= 25%"
  - "Total reduction from original >= 78%"
  - "Payment domain specs/docs retained"
  - "Auth domain removed"
  - "PM and Tech Lead agents retained (planning needed)"
  - "Confidence >= 0.90"

success_criteria:
  - "Feature development pattern recognized"
  - "Domain filtering appropriate for focused scope"
  - "Planning agents kept (PM, Tech Lead)"
  - "Integration docs retained for context"
  - "Unrelated domains removed"
  - "High confidence in analysis"
---
