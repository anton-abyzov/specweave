---
name: "NextJS App with NextAuth.js Authentication"
description: "Add NextAuth.js v5 with credentials and OAuth providers"
skill: nextjs-agent
priority: P1
estimated_time: "10 minutes"

input:
  prompt: "Add NextAuth.js authentication with Google OAuth and credentials"
  requirements:
    auth: nextauth_v5
    providers:
      - credentials
      - google
    protected_routes: true

expected_output:
  files_created:
    - app/api/auth/[...nextauth]/route.ts
    - app/(auth)/login/page.tsx
    - app/(auth)/register/page.tsx
    - lib/auth.ts                          # Auth config
    - middleware.ts                        # Protected routes
    - app/(dashboard)/dashboard/page.tsx   # Protected page

  auth_config:
    providers:
      - name: credentials
        fields:
          - email
          - password

      - name: google
        clientId: "env.GOOGLE_CLIENT_ID"
        clientSecret: "env.GOOGLE_CLIENT_SECRET"

  environment_variables:
    - NEXTAUTH_URL: "http://localhost:3000"
    - NEXTAUTH_SECRET: "[generated-secret]"
    - GOOGLE_CLIENT_ID: "[your-google-client-id]"
    - GOOGLE_CLIENT_SECRET: "[your-google-client-secret]"

  route_protection:
    protected_routes:
      - /dashboard
      - /api/protected/*
    public_routes:
      - /
      - /login
      - /register

  session_management:
    strategy: jwt
    maxAge: "30 days"

  middleware_config:
    matcher:
      - "/dashboard/:path*"
      - "/api/protected/:path*"

validation:
  - "NextAuth.js configured correctly"
  - "Login page accessible"
  - "Protected routes redirect to login"
  - "Session persists after login"
  - "Google OAuth flow works (if credentials set)"

success_criteria:
  - "Authentication working"
  - "Protected routes secured"
  - "Session management functional"
  - "Environment variables documented"
---
