---
total_tasks: {{TOTAL_TASKS}}
completed: 0
by_user_story:
  {{#USER_STORIES}}
  {{US_ID}}: {{TASK_COUNT}}
  {{/USER_STORIES}}
test_mode: {{TEST_MODE}}
coverage_target: {{COVERAGE_TARGET}}
---

# Tasks: {{INCREMENT_TITLE}}

**Increment**: {{INCREMENT_ID}}
**Status**: Planning
**Created**: {{CREATED_DATE}}

---

## Task Format (US-Task Linkage - v0.23.0)

**NEW**: All tasks MUST explicitly link to their parent User Story and Acceptance Criteria.

### Required Fields for Each Task:
```markdown
### T-XXX: Task Title

**User Story**: US-XXX
**Satisfies ACs**: AC-USXX-YY, AC-USXX-ZZ
**Status**: [ ] pending | [x] completed | [~] in_progress | [-] canceled
**Priority**: P0 (Critical) | P1 (Important) | P2 (Nice-to-have) | P3 (Future)
**Estimated Effort**: X hours | X days

**Description**: What this task accomplishes and why it's needed.

**Implementation Steps**:
1. Create/update file or component
2. Implement core logic
3. Add error handling
4. Add tests
5. Update documentation

**Test Plan**:
- Unit tests: Specific test cases to write
- Integration tests: End-to-end scenarios
- Coverage target: 95% (unit), 85% (integration)

**Files Affected**:
- `path/to/file.ts` (create/modify)
- `path/to/test.ts` (create)

**Dependencies**: T-XXX (optional - tasks that must complete first)
```

### Hierarchical Structure

Tasks are **grouped by User Story** for traceability:

```markdown
## User Story: US-001 - User Story Title

**Linked ACs**: AC-US1-01, AC-US1-02, AC-US1-03
**Tasks**: X total, Y completed

### T-001: First task for this US
**User Story**: US-001
**Satisfies ACs**: AC-US1-01, AC-US1-02
...

### T-002: Second task for this US
**User Story**: US-001
**Satisfies ACs**: AC-US1-03
...

---

## User Story: US-002 - Another User Story

**Linked ACs**: AC-US2-01, AC-US2-02
**Tasks**: X total, Y completed

### T-003: First task for US-002
**User Story**: US-002
**Satisfies ACs**: AC-US2-01
...
```

---

{{#USER_STORIES}}
## User Story: {{US_ID}} - {{US_TITLE}}

**Linked ACs**: {{AC_IDS}}
**Tasks**: {{TASK_COUNT}} total, 0 completed

{{#TASKS}}
### {{TASK_ID}}: {{TASK_TITLE}}

**User Story**: {{US_ID}}
**Satisfies ACs**: {{SATISFIES_ACS}}
**Status**: [ ] pending
**Priority**: {{PRIORITY}}
**Estimated Effort**: {{ESTIMATE}}

**Description**: {{DESCRIPTION}}

**Implementation Steps**:
{{#IMPLEMENTATION_STEPS}}
- [ ] {{STEP}}
{{/IMPLEMENTATION_STEPS}}

**Test Plan** (BDD):
- **Given** {{GIVEN}}
- **When** {{WHEN}}
- **Then** {{THEN}}

**Test Cases**:
- Unit (`{{TEST_FILE}}`):
  {{#UNIT_TESTS}}
  - {{TEST_NAME}}
  {{/UNIT_TESTS}}
  - Coverage: >95%
{{#HAS_INTEGRATION_TESTS}}
- Integration (`{{INTEGRATION_TEST_FILE}}`):
  {{#INTEGRATION_TESTS}}
  - {{TEST_NAME}}
  {{/INTEGRATION_TESTS}}
  - Coverage: >85%
{{/HAS_INTEGRATION_TESTS}}

**Files Affected**:
{{#FILES_TO_CREATE}}
- `{{FILE_PATH}}` (create)
{{/FILES_TO_CREATE}}
{{#FILES_TO_MODIFY}}
- `{{FILE_PATH}}` (modify)
{{/FILES_TO_MODIFY}}

{{#HAS_DEPENDENCIES}}
**Dependencies**: {{DEPENDENCIES}}
{{/HAS_DEPENDENCIES}}

---

{{/TASKS}}
{{/USER_STORIES}}

## Validation Rules (v0.23.0)

Before closing this increment, the following MUST be true:

1. **All tasks completed**: Every task marked `[x] completed`
2. **All ACs covered**: Every AC-ID from spec.md has at least one task
3. **No orphan tasks**: Every task has **Satisfies ACs** field
4. **Valid linkage**: All US-IDs and AC-IDs exist in spec.md

**Validation commands**:
```bash
# Check AC coverage and task linkage
/specweave:validate {{INCREMENT_ID}}

# Close increment (validates automatically)
/specweave:done {{INCREMENT_ID}}
```

---

## Progress Tracking

**By User Story**:
{{#USER_STORIES}}
- {{US_ID}}: 0/{{TASK_COUNT}} tasks completed (0%)
{{/USER_STORIES}}

**Overall**: 0/{{TOTAL_TASKS}} tasks completed (0%)

---

## Task Dependencies (Auto-Generated)

```mermaid
graph TD
{{#TASK_DEPENDENCIES}}
    {{FROM_TASK}}[{{FROM_TASK_TITLE}}] --> {{TO_TASK}}[{{TO_TASK_TITLE}}]
{{/TASK_DEPENDENCIES}}
```

---

## Testing Checklist

**Unit Tests** (per component):
{{#COMPONENTS}}
- [ ] {{COMPONENT_NAME}}
{{/COMPONENTS}}

**Integration Tests**:
- [ ] Full workflow (end-to-end)
- [ ] Error handling
- [ ] Edge cases

**E2E Tests** (if applicable):
{{#E2E_TESTS}}
- [ ] {{E2E_TEST_NAME}}
{{/E2E_TESTS}}

---

## Success Criteria

**Must Have** (P0/P1):
- [ ] All critical and important tasks completed
- [ ] All tests passing (unit, integration, E2E)
- [ ] 100% AC coverage validated
- [ ] Documentation updated (CLAUDE.md, README.md)
- [ ] Code review approved

**Nice to Have** (P2/P3 - can defer):
{{#NICE_TO_HAVE}}
- [ ] {{FEATURE}}
{{/NICE_TO_HAVE}}

---

## Rollout Plan

### Week 1: Foundation
{{#WEEK_1_TASKS}}
- Days {{DAYS}}: Tasks {{TASK_RANGE}}
{{/WEEK_1_TASKS}}

### Week 2: Core Implementation
{{#WEEK_2_TASKS}}
- Days {{DAYS}}: Tasks {{TASK_RANGE}}
{{/WEEK_2_TASKS}}

### Week 3: Integration & Testing
{{#WEEK_3_TASKS}}
- Days {{DAYS}}: Tasks {{TASK_RANGE}}
{{/WEEK_3_TASKS}}

---

## Notes

**Important**:
- This tasks.md uses **hierarchical structure grouped by User Story** (v0.23.0+)
- All tasks MUST link to parent US and ACs for traceability
- Validation enforces 100% AC coverage before increment closure
- Living docs sync automatically based on task-AC linkage

**See**: `CLAUDE.md` section "Task Format with US-Task Linkage" for detailed guide

---

**Version**: 2.0 (US-Task Linkage)
**Last Updated**: {{LAST_UPDATED}}
**Total Estimate**: {{TOTAL_HOURS}} hours ({{TOTAL_WEEKS}} weeks)
