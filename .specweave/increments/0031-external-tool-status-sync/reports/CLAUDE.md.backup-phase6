# SpecWeave - Development Guide

**Project**: SpecWeave - Spec-Driven Development Framework
**Type**: Open Source NPM Package (TypeScript CLI)
**Repository**: https://github.com/anton-abyzov/specweave
**Website**: https://spec-weave.com

This CLAUDE.md is for **contributors to SpecWeave itself**, not users of SpecWeave.
Users receive a different CLAUDE.md via the template system.

---

## üö® CRITICAL: NEVER POLLUTE PROJECT ROOT!

**‚õî THIS IS THE #1 RULE - VIOLATING THIS WILL GET YOUR PR REJECTED ‚õî**

**ALL AI-generated files MUST go into the CURRENT INCREMENT folder**, NOT in the project root!

### ‚ùå NEVER Create in Root (Pollutes Repository)

```
‚ùå WRONG - ROOT FILES (REJECTED!):
/PLUGIN-MIGRATION-COMPLETE.md          # NO! Goes to increment reports/
/SESSION-SUMMARY-2025-10-28.md         # NO! Goes to increment reports/
/ADR-006-DEEP-ANALYSIS.md              # NO! Goes to .specweave/docs/internal/architecture/adr/
/ANALYSIS-MULTI-TOOL-COMPARISON.md     # NO! Goes to increment reports/
/migration-helper.sh                   # NO! Goes to increment scripts/
/execution.log                         # NO! Goes to increment logs/
/specweave-0.5.1.tgz                   # NO! Build artifact, should be in .gitignore
/yolov8n.pt                            # NO! ML model, should be in .gitignore

‚úÖ CORRECT - INCREMENT FOLDERS:
.specweave/increments/0004-plugin-architecture/
‚îú‚îÄ‚îÄ spec.md                            # Spec files (core 3)
‚îú‚îÄ‚îÄ plan.md
‚îú‚îÄ‚îÄ tasks.md                           # Tasks with embedded tests
‚îú‚îÄ‚îÄ reports/                           # ‚úÖ PUT REPORTS HERE!
‚îÇ   ‚îú‚îÄ‚îÄ PLUGIN-MIGRATION-COMPLETE.md   # ‚úÖ Completion reports
‚îÇ   ‚îú‚îÄ‚îÄ SESSION-SUMMARY.md             # ‚úÖ Session summaries
‚îÇ   ‚îî‚îÄ‚îÄ ANALYSIS-*.md                  # ‚úÖ Analysis files
‚îú‚îÄ‚îÄ scripts/                           # ‚úÖ PUT SCRIPTS HERE!
‚îÇ   ‚îî‚îÄ‚îÄ migration-helper.sh            # ‚úÖ Helper scripts
‚îî‚îÄ‚îÄ logs/                              # ‚úÖ PUT LOGS HERE!
    ‚îî‚îÄ‚îÄ execution.log                  # ‚úÖ Execution logs

.specweave/docs/internal/architecture/ # ‚úÖ PUT ADRS/DIAGRAMS HERE!
‚îî‚îÄ‚îÄ adr/
    ‚îî‚îÄ‚îÄ 0006-deep-analysis.md          # ‚úÖ Architecture decisions
```

### Why This Matters

- ‚úÖ **Complete traceability** - Know which increment created which files
- ‚úÖ **Easy cleanup** - Delete increment folder = delete all files
- ‚úÖ **Clear context** - All files for a feature in one place
- ‚úÖ **No root clutter** - Project root stays clean and professional
- ‚úÖ **Better git history** - Changes grouped by increment
- ‚úÖ **Status line works correctly** - Parses tasks.md without confusion from extra .md files

### ‚ö†Ô∏è CRITICAL: reports/ Folder is MANDATORY!

**EVERY increment MUST have a reports/ subfolder for ALL analysis and summary files:**

```bash
# ‚úÖ CORRECT Structure:
.specweave/increments/0017-sync-fix/
‚îú‚îÄ‚îÄ spec.md                         # Core: What we're building
‚îú‚îÄ‚îÄ plan.md                         # Core: How we'll build it
‚îú‚îÄ‚îÄ tasks.md                        # Core: Task checklist (REQUIRED for status line!)
‚îú‚îÄ‚îÄ reports/                        # üìÅ ALL reports and analysis go here!
‚îÇ   ‚îú‚îÄ‚îÄ STATUS-LINE-DEBUG.md        # ‚úÖ Analysis files
‚îÇ   ‚îú‚îÄ‚îÄ TEST-REPORT-COMPLETE.md     # ‚úÖ Test reports
‚îÇ   ‚îú‚îÄ‚îÄ IMPLEMENTATION-SUMMARY.md   # ‚úÖ Implementation summaries
‚îÇ   ‚îú‚îÄ‚îÄ CODE-REVIEW-*.md            # ‚úÖ Code review reports
‚îÇ   ‚îî‚îÄ‚îÄ SESSION-SUMMARY-*.md        # ‚úÖ Session notes
‚îú‚îÄ‚îÄ scripts/                        # Optional: Helper scripts
‚îî‚îÄ‚îÄ logs/                           # Optional: Execution logs

# ‚ùå WRONG - Files in root will BREAK status line!
.specweave/increments/0017-sync-fix/
‚îú‚îÄ‚îÄ spec.md
‚îú‚îÄ‚îÄ plan.md
‚îú‚îÄ‚îÄ tasks.md
‚îú‚îÄ‚îÄ TEST-REPORT-COMPLETE.md         # ‚ùå NO! Breaks status line parsing
‚îú‚îÄ‚îÄ ANALYSIS-*.md                   # ‚ùå NO! Confuses file parsers
‚îî‚îÄ‚îÄ SESSION-SUMMARY.md              # ‚ùå NO! Should be in reports/
```

**Why reports/ folder matters for status line**:
- Status line parses `tasks.md` to count progress
- Extra `.md` files in root can confuse the parser
- Files MUST be in `reports/` subfolder for clean parsing
- **Without proper structure ‚Üí Status line shows nothing!**

**Rule**: Only 3 core files allowed in increment root: `spec.md`, `plan.md`, `tasks.md`. Everything else ‚Üí subfolders!

### What IS Allowed in Root?

**ONLY these files belong in root**:
- ‚úÖ `CLAUDE.md` (this file - contributor guide)
- ‚úÖ `README.md`, `CHANGELOG.md`, `LICENSE` (project documentation)
- ‚úÖ `package.json`, `tsconfig.json`, `.gitignore` (config files)
- ‚úÖ Directories: `src/`, `tests/`, `plugins/`, `.specweave/`, etc. (source code)

**Everything else goes in increment folders or `.gitignore`!**

### Build Artifacts (Add to .gitignore)

These should NEVER be committed:
- ‚ùå `*.tgz`, `*.tar.gz` - NPM package archives
- ‚ùå `*.pt`, `*.pth` - ML model files (download on demand)
- ‚ùå `dist/`, `build/` - Compiled outputs (already in .gitignore)
- ‚ùå `*.log` - Log files (already in .gitignore)

**Before committing, ALWAYS check**: `git status` - If you see `.md` files in root, MOVE THEM!

---

## Why Claude Code is Best-in-Class

**CRITICAL**: SpecWeave is designed for Claude Code FIRST. Other tools are supported but with reduced capabilities.

**Quick Summary**:
- ‚úÖ **Automated living docs** - Syncs after every task (zero manual work)
- ‚úÖ **Progressive disclosure** - 60-80% context reduction via skills
- ‚úÖ **Native hooks** - Lifecycle automation (post-task, pre-implementation)
- ‚úÖ **Isolated agent contexts** - Clean separation, better performance
- ‚úÖ **Plugin-based commands** - `/specweave:*` commands work everywhere

**For detailed comparison and technical architecture**: See [Why Claude Code is Best-in-Class](https://spec-weave.com/docs/overview/why-claude-code) (comprehensive guide with feature comparison, real-world examples, and FAQ)

---

## Increment Naming Convention

**CRITICAL**: All increments MUST use descriptive names, not just numbers.

**Format**: `####-descriptive-kebab-case-name`

**Examples**:
- ‚úÖ `0001-core-framework` ‚Üê Clear what it does
- ‚úÖ `0003-intelligent-model-selection` ‚Üê Searchable
- ‚ùå `0003` ‚Üê Too generic (rejected!)

**Why**: Clear intent, better git history, searchable, self-documenting.

**For complete naming rules**: See `increment-planner` skill (auto-loads when using `/specweave:increment`)

---

## Increment Discipline

**‚õî THE IRON RULE**: You CANNOT start increment N+1 until increment N is DONE.

**Core Philosophy**:
- ‚úÖ **Default**: 1 active increment (maximum productivity)
- ‚úÖ **Emergency ceiling**: 2 active max (hotfix/bug can interrupt)
- ‚úÖ **Hard cap**: Never >2 active (enforced)

**Why**: Focus = Quality. Research shows 1 task = 100% productivity, 2 tasks = 20% slower, 3+ = 40% slower + more bugs.

**For complete discipline rules**: See [Increment Lifecycle Guide](.specweave/docs/internal/delivery/guides/increment-lifecycle.md#increment-discipline-the-iron-rule)

This guide auto-loads when using increment commands (progressive disclosure pattern).

**Quick Reference**:
- Complete work: `/specweave:do`
- Close increments: `/specweave:close` (3 options: adjust scope, move scope, extend)
- Check status: `/specweave:status`
- Emergency bypass: `--force` (use sparingly!)

**What "DONE" means**: All P1 tasks completed OR completion report exists OR explicit closure via `/specweave:done`.

---

## Test-Aware Planning

**NEW in v0.7.0**: Tests embedded in tasks.md (no separate tests.md).

**Architecture**:
- **spec.md**: User stories with AC-IDs (AC-US1-01, AC-US1-02)
- **plan.md**: Technical design + test strategy
- **tasks.md**: Tasks with embedded test plans (BDD format)

**Example Task with Tests**:
```markdown
## T-001: Implement Authentication Service

**AC**: AC-US1-01, AC-US1-02, AC-US1-03

**Test Plan** (BDD):
- **Given** valid credentials ‚Üí **When** login ‚Üí **Then** receive JWT token

**Test Cases**:
- Unit (`auth.test.ts`): validLogin, invalidPassword ‚Üí 90% coverage
- Integration (`auth-flow.test.ts`): loginEndpoint ‚Üí 85% coverage

**Implementation**: AuthService.ts, bcrypt, JWT, Redis rate limiting
```

**Key Benefits**:
- ‚úÖ Single source of truth (no sync issues)
- ‚úÖ AC-ID traceability (spec ‚Üí tasks ‚Üí tests)
- ‚úÖ BDD format (Given/When/Then - clear intent)
- ‚úÖ TDD support (set `test_mode: TDD` in frontmatter)
- ‚úÖ Realistic coverage (80-90%, not 100%)

**For complete workflow**: The `increment-planner` skill contains comprehensive test-aware planning guide (auto-loads when using `/specweave:increment`)

**Validation**: `/specweave:check-tests` shows AC-ID coverage and missing tests

---

## Root-Level .specweave/ Folder (MANDATORY)

**CRITICAL ARCHITECTURE RULE**: SpecWeave ONLY supports root-level `.specweave/` folders. Nested `.specweave/` folders are NOT supported and MUST be prevented.

### The Rule: ONE Source of Truth

```
‚úÖ CORRECT - Root-level only:
my-project/
‚îú‚îÄ‚îÄ .specweave/              ‚Üê ONE source of truth
‚îÇ   ‚îú‚îÄ‚îÄ increments/
‚îÇ   ‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ logs/
‚îú‚îÄ‚îÄ frontend/
‚îú‚îÄ‚îÄ backend/
‚îî‚îÄ‚îÄ infrastructure/

‚ùå WRONG - Nested .specweave/ (NOT SUPPORTED):
my-project/
‚îú‚îÄ‚îÄ .specweave/              ‚Üê Root level
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îî‚îÄ‚îÄ .specweave/          ‚Üê ‚ùå NESTED - PREVENTS THIS!
‚îî‚îÄ‚îÄ frontend/
    ‚îî‚îÄ‚îÄ .specweave/          ‚Üê ‚ùå NESTED - PREVENTS THIS!
```

### Why Root-Level Only?

**Single Source of Truth**:
- ‚úÖ One central location for all specs, increments, architecture
- ‚úÖ No duplication or fragmentation
- ‚úÖ Clear ownership and responsibility
- ‚úÖ Simplified living docs sync (one place to update)

**Cross-Cutting Features**:
- ‚úÖ Increments often span multiple modules (frontend + backend + infra)
- ‚úÖ Architecture decisions (ADRs) apply system-wide
- ‚úÖ Strategy docs are project-level, not module-level
- ‚úÖ Living docs sync works best with one central location

**Plugin Installation**:
- ‚úÖ ALL plugins installed automatically during `specweave init`
- ‚úÖ No selective loading or detection needed
- ‚úÖ Full capabilities available immediately

**Prevents Chaos**:
- ‚ùå Nested folders cause: Which is the source of truth?
- ‚ùå Duplication: Same increment in multiple places?
- ‚ùå Conflicts: Different modules with same increment numbers?
- ‚ùå Complexity: Where do cross-cutting features live?

### Multi-Repo & Microservices Pattern

**Problem**: "My project has multiple repos, microservices, or complex architecture"

**Solution**: Create a **parent folder** with ONE root-level `.specweave/`

SpecWeave supports **THREE approaches** for multi-repo projects:

**Option 2: Parent Repo on GitHub** (‚úÖ Recommended for teams)
- Parent folder is a GitHub repository
- Team can clone and collaborate on specs/docs
- Full version control for .specweave/
- Works with CI/CD pipelines

**Option 3: Local Parent Folder** (‚úÖ Recommended for solo developers)
- Parent folder stays on your machine (NOT pushed to GitHub)
- .specweave/ is gitignored (local only)
- Implementation repos still on GitHub
- Lighter setup, less overhead

**Option 4: Each Repo Has .specweave/** (‚ùå NOT RECOMMENDED)
- Each repo maintains its own .specweave/ folder
- Leads to fragmentation and duplication
- Difficult to manage cross-cutting features
- Only use if you absolutely must

The pattern is the same whether you have:
- Multiple git repos (polyrepo architecture)
- Microservices (separate service directories)
- Monorepo with multiple modules

```
microservices-project/       ‚Üê Create parent folder
‚îú‚îÄ‚îÄ .specweave/              ‚Üê ONE source of truth for entire system
‚îÇ   ‚îú‚îÄ‚îÄ increments/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 0001-add-service-mesh/      ‚Üê Cross-cutting
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 0002-user-svc-v2/           ‚Üê Single service
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 0003-checkout-flow/         ‚Üê Multi-service
‚îÇ   ‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strategy/               ‚Üê System-wide strategy
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service-mesh.md     ‚Üê System-wide
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api-contracts.md    ‚Üê Cross-service
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ adr/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ 0001-service-mesh-choice.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ logs/
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ user-service/        ‚Üê Can be separate git repos
‚îÇ   ‚îú‚îÄ‚îÄ order-service/       ‚Üê Or monorepo subdirectories
‚îÇ   ‚îú‚îÄ‚îÄ payment-service/
‚îÇ   ‚îî‚îÄ‚îÄ notification-service/
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îú‚îÄ‚îÄ k8s/
‚îÇ   ‚îî‚îÄ‚îÄ terraform/
‚îÇ
‚îî‚îÄ‚îÄ shared/
    ‚îî‚îÄ‚îÄ api-contracts/
```

**How to Set Up**:

```bash
# APPROACH 1: Parent Repo on GitHub (Option 2)
# Step 1: Run specweave init and select "Option 2: Multiple repos WITH parent repo (GitHub)"
mkdir microservices-project && cd microservices-project
npx specweave init .
# ‚Üí Select: "2Ô∏è‚É£  Multiple repos WITH parent repo (GitHub)"
# ‚Üí Creates .specweave/ and pushes to GitHub

# Step 2: Clone implementation repos
git clone https://github.com/myorg/user-service.git services/user-service
git clone https://github.com/myorg/order-service.git services/order-service

# APPROACH 2: Local Parent Folder (Option 3) - NEW!
# Step 1: Run specweave init and select "Option 3: Local parent folder"
mkdir my-parent-folder && cd my-parent-folder
npx specweave init .
# ‚Üí Select: "3Ô∏è‚É£  Multiple repos WITH parent folder (LOCAL only)"
# ‚Üí Creates .specweave/ (gitignored, local only)

# Step 2: Clone implementation repos
git clone https://github.com/myorg/frontend.git frontend
git clone https://github.com/myorg/backend.git backend

# .specweave/ stays on your machine, NOT synced to GitHub!

# APPROACH 3: Monorepo (services in same repo)
mkdir microservices-project && cd microservices-project
git init && npx specweave init .
# ‚Üí Select: "1Ô∏è‚É£  Single repository" OR "5Ô∏è‚É£  Monorepo"
mkdir -p services/{user,order,payment}

# Work normally - SpecWeave sees all services
/specweave:increment "0001-add-service-mesh"
# Creates: .specweave/increments/0001-add-service-mesh/
# Can reference: services/user-service/, infrastructure/k8s/, etc.
```

**Benefits**:

**All approaches**:
- ‚úÖ One `.specweave/` for entire system (no duplication)
- ‚úÖ Each repo maintains its own git history (if using polyrepo)
- ‚úÖ Cross-service increments are natural (e.g., checkout flow)
- ‚úÖ System-wide architecture docs in one place
- ‚úÖ Living docs cover all services

**Option 2 (GitHub Parent) specific**:
- ‚úÖ Team can collaborate on specs/docs
- ‚úÖ Full version control history for .specweave/
- ‚úÖ Works with CI/CD pipelines
- ‚úÖ Can enforce code reviews for specs

**Option 3 (Local Parent) specific**:
- ‚úÖ Lighter setup (no GitHub repo for parent)
- ‚úÖ No extra repository to manage
- ‚úÖ Perfect for solo developers
- ‚úÖ .specweave/ stays private on your machine

### Enforcement

**Validation in `init.ts`**:

```typescript
// Check for parent .specweave/
function detectNestedSpecweave(targetDir: string): string | null {
  let currentDir = path.dirname(targetDir);
  const root = path.parse(currentDir).root;

  while (currentDir !== root) {
    const specweavePath = path.join(currentDir, '.specweave');
    if (fs.existsSync(specweavePath)) {
      return currentDir; // Found parent .specweave/
    }
    currentDir = path.dirname(currentDir);
  }

  return null;
}

// Prevent nested initialization
const parentSpecweave = detectNestedSpecweave(targetDir);
if (parentSpecweave) {
  console.error('‚ùå Nested .specweave/ folders are not supported!');
  console.error(`   Found parent .specweave/ at: ${parentSpecweave}`);
  console.error(`   Use the parent folder for all increments.`);
  process.exit(1);
}
```

**Detection Rules**:
- ‚ùå Prevent `specweave init` in subdirectories if parent `.specweave/` exists
- ‚úÖ Suggest using parent folder instead
- ‚úÖ Provide clear error messages with path to parent

**Code Review**:
- ‚ùå Reject PRs with nested `.specweave/` folders
- ‚úÖ Enforce via linting/validation scripts

### Summary

| Aspect | Root-Level Only | Nested (NOT Supported) |
|--------|----------------|------------------------|
| **Source of Truth** | ‚úÖ One central location | ‚ùå Multiple conflicting sources |
| **Cross-Cutting Features** | ‚úÖ Natural | ‚ùå Complex coordination |
| **Living Docs Sync** | ‚úÖ Simple | ‚ùå Merge conflicts |
| **Plugin Detection** | ‚úÖ Works | ‚ùå Ambiguous |
| **Multi-Repo** | ‚úÖ Parent folder | ‚ùå Fragmented |
| **Complexity** | ‚úÖ Simple | ‚ùå High |

**Bottom Line**: Root-level `.specweave/` only. For multi-repo projects, create a parent folder. No exceptions.

---

## Project Scale - Plugin Architecture

### Core Plugin (Always Auto-Loaded)

**Plugin**: `specweave` - The essential SpecWeave plugin loaded in every project:
- **Skills**: 9 skills (increment-planner, tdd-workflow, spec-generator, context-loader, project-kickstarter, brownfield-analyzer, brownfield-onboarder, increment-quality-judge, context-optimizer)
- **Agents**: 22 agents (PM, Architect, Tech Lead, + 19 specialized including tdd-orchestrator)
- **Commands**: 22 commands (/specweave:increment, /specweave:do, /specweave:next, /specweave:done, /specweave:progress, /specweave:validate, /specweave:sync-docs, + 15 specialized)
- **Hooks**: 8 lifecycle hooks
- **Size**: ~12K tokens

**Result**: **75%+ context reduction** out of the box!

**Why So Small?**
- External sync (GitHub, Jira) = separate plugins
- Tech stacks (React, K8s) = separate plugins
- Domain expertise (ML, payments) = separate plugins
- Core plugin = only increment lifecycle + living docs automation

### Available Plugins (All Auto-Installed)

**Implemented Plugins**:

| Plugin | Skills | Agents | Commands | Status |
|--------|--------|--------|----------|--------|
| **specweave-github** | 2 | 1 | 4 | ‚úÖ COMPLETE |

**GitHub Plugin Features:**
- github-sync: Bidirectional increment ‚Üî issue sync
- github-issue-tracker: Task-level progress tracking
- github-manager agent: AI specialist for GitHub CLI
- Commands: create-issue, sync, close-issue, status
- Auto-detects: `.git/`, `github.com` remote, `GITHUB_TOKEN`

**Planned Plugins** (future releases):

| Plugin | Skills | Agents | Commands | Use When |
|--------|--------|--------|----------|----------|
| **frontend-stack** | 5 | 1 | 0 | React, Next.js, design systems |
| **kubernetes** | 3 | 1 | 2 | Deploying to K8s, Helm |

**Domain Plugins**:

| Plugin | Skills | Agents | Commands | Use When |
|--------|--------|--------|----------|----------|
| **ml-ops** | 3 | 3 | 1 | Machine learning, TensorFlow, PyTorch |
| **observability** | 4 | 4 | 2 | Prometheus, Grafana, monitoring |
| **payment-processing** | 4 | 1 | 0 | Stripe, billing, subscriptions |
| **e2e-testing** | 1 | 0 | 0 | Playwright, E2E browser automation, visual regression |
| **figma-ecosystem** | 5 | 2 | 0 | Design integration, Figma API |
| **security** | 3 | 1 | 0 | Security scanning, best practices |
| **diagrams** | 2 | 1 | 0 | C4 diagrams, Mermaid |

**Backend Stacks**:

| Plugin | Skills | Agents | Commands | Use When |
|--------|--------|--------|----------|----------|
| **nodejs-backend** | 1 | 1 | 0 | Express, Fastify, NestJS |
| **python-backend** | 1 | 1 | 0 | FastAPI, Django, Flask |
| **dotnet-backend** | 1 | 1 | 0 | ASP.NET Core, EF Core |

**Enterprise Sync** (Alternative to GitHub):

| Plugin | Skills | Agents | Commands | Use When |
|--------|--------|--------|----------|----------|
| **jira-sync** | 1 | 1 | 2 | JIRA project tracking |
| **ado-sync** | 1 | 1 | 2 | Azure DevOps tracking |

### Context Efficiency

**All plugins are installed, but only relevant skills activate based on context**. Claude Code's native skill system ensures:
- Skills only activate when their description keywords match the conversation
- Agents only load when explicitly invoked
- Commands only appear when relevant

**Example**: Working on a React frontend:
- ‚úÖ `specweave-frontend` skills activate (React, Next.js, design systems)
- ‚úÖ `specweave-github` skills activate (if mentioning GitHub)
- ‚ùå `specweave-ml` skills stay dormant (ML keywords not detected)
- ‚ùå `specweave-payments` skills stay dormant (Stripe not mentioned)

**Result**: Even with 19+ plugins installed, you only "pay" (in tokens) for what you're actively using in the conversation.

### How Plugins Are Loaded (All Plugins Installed Upfront)

**SpecWeave's plugin system is designed to be intelligent and non-intrusive:**

#### Phase 1: Initialize (FULLY AUTOMATED!)

When you run `specweave init`:

1. ‚úÖ **GitHub Marketplace Registration** (CLI-Only, GLOBAL)
   - Registers marketplace via CLI: `claude plugin marketplace add anton-abyzov/specweave`
   - **Marketplace is GLOBAL** - persists across ALL projects, not per-project
   - **No `.claude/settings.json` created** - redundant because CLI registration is global
   - Installation process:
     1. Removes existing marketplace (if present)
     2. Re-adds marketplace from GitHub (always fresh)
     3. Reads marketplace.json to get list of all plugins
     4. Installs each plugin via `claude plugin install {name}`
     5. Reports success/failure for each plugin
   - All slash commands available IMMEDIATELY - no manual install needed!
   - Success message: "‚úî Installed: 19/19 plugins"
   - Graceful fallback: If CLI unavailable, shows manual install instructions
   - **No selective loading**: Everything installed upfront for full capabilities

**Key Architectural Change**:
- ‚ùå Old: Copied `.claude-plugin/` + `plugins/` to every project (~2MB bloat)
- ‚úÖ New: CLI-based GLOBAL marketplace registration (zero per-project files, always up-to-date)

#### Phase 2: Implementation (All Plugins Ready)

After `specweave init`, ALL plugins are already installed. No additional steps needed!

1. **Skills Auto-Activate**
   - Based on description keywords (Claude Code native behavior)
   - No manual invocation needed
   - Example: Mention "GitHub" ‚Üí github-sync skill activates

2. **All Capabilities Available**
   - GitHub integration: `/specweave-github:sync`
   - JIRA integration: `/specweave-jira:sync`
   - Frontend tools: React, Next.js, design systems
   - Backend tools: Node.js, Python, .NET
   - Infrastructure: Kubernetes, Helm, monitoring
   - ...and 19+ more plugins ready to use!

### Plugin Management

**All 19+ plugins are automatically installed during `specweave init`**. You rarely need to manage plugins manually, but Claude Code's native commands are available if needed:

```bash
# List installed plugins (should show all 19+ SpecWeave plugins)
/plugin list --installed

# Uninstall a plugin (not recommended - breaks functionality)
/plugin uninstall specweave-kubernetes

# Reinstall all plugins (if you uninstalled something by mistake)
specweave init .  # Re-runs full installation
```

**Key Insight**: SpecWeave uses **ONLY** Claude Code's native plugin system:
- ALL plugins installed automatically during init (no manual selection)
- Plugins install globally via `/plugin install specweave-{name}`
- Work across ALL projects (like VS Code extensions)
- Auto-activate based on skills' description keywords
- Managed by Claude Code (updates handled via `specweave init` re-run)

### Development vs Production Setup

**Two different scenarios with different marketplace configurations:**

#### SpecWeave Repo (Development)

```
specweave/  (GitHub repo - Contributors)
‚îú‚îÄ‚îÄ .claude/
‚îÇ   ‚îî‚îÄ‚îÄ settings.json              # Empty or minimal (no local paths supported)
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ marketplace.json           # Marketplace definition
‚îî‚îÄ‚îÄ plugins/
    ‚îú‚îÄ‚îÄ specweave/                 # Core plugin SOURCE CODE
    ‚îî‚îÄ‚îÄ specweave-github/          # Plugin SOURCE CODE
```

**Marketplace setup for development** (use CLI, NOT settings.json):

Local paths are **NOT supported** in `extraKnownMarketplaces` in settings.json. Use CLI instead:

```bash
# Add local marketplace (only way for development)
/plugin marketplace add ./.claude-plugin

# Then install plugins
/plugin install specweave
```

**Why CLI-only?** Claude Code's `extraKnownMarketplaces` in settings.json only supports remote sources (GitHub, Git). Local paths must be added via CLI commands.

#### User Projects (Production)

```
my-saas-app/  (User's project)
‚îú‚îÄ‚îÄ .specweave/                    # SpecWeave data ONLY
‚îÇ   ‚îî‚îÄ‚îÄ increments/
‚îî‚îÄ‚îÄ src/
```

**NO `.claude/` folder created!** Marketplace registration is GLOBAL via CLI, not per-project.

**Marketplace Registration** (via `specweave init`):
```bash
# Registers marketplace GLOBALLY (persists across all projects)
claude plugin marketplace add anton-abyzov/specweave

# Check registration (works from ANY project)
claude plugin marketplace list
# Output: ‚ùØ specweave (Source: GitHub anton-abyzov/specweave)
```

**Key Differences**:
- ‚úÖ **Development**: Local `.claude-plugin/` and `plugins/` in repo (for editing)
- ‚úÖ **Production**: GLOBAL CLI registration (zero per-project files)
- ‚úÖ **Development**: Use CLI `/plugin marketplace add ./.claude-plugin`
- ‚úÖ **Production**: Use CLI `claude plugin marketplace add anton-abyzov/specweave`
- ‚úÖ **Both**: Marketplace persists across projects and IDE restarts

No per-project installation needed!

---

## Project Architecture

### Source of Truth Principle

**CRITICAL**: SpecWeave follows a strict source-of-truth pattern:

```
src/                            ‚Üê SOURCE OF TRUTH (TypeScript code only)
‚îú‚îÄ‚îÄ core/                       ‚Üê Core framework logic (TypeScript utilities)
‚îÇ   ‚îú‚îÄ‚îÄ plugin-loader.ts
‚îÇ   ‚îú‚îÄ‚îÄ config-manager.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/                  ‚Üê TypeScript type definitions
‚îÇ   ‚îî‚îÄ‚îÄ schemas/                ‚Üê JSON schemas
‚îú‚îÄ‚îÄ cli/                        ‚Üê CLI commands
‚îú‚îÄ‚îÄ hooks/                      ‚Üê TypeScript utilities for hooks
‚îÇ   ‚îî‚îÄ‚îÄ lib/                    ‚Üê Hook helper functions
‚îú‚îÄ‚îÄ adapters/                   ‚Üê Tool adapters (legacy)
‚îú‚îÄ‚îÄ templates/                  ‚Üê Templates for user projects
‚îî‚îÄ‚îÄ utils/                      ‚Üê Utility functions

plugins/                        ‚Üê ROOT: All plugins (version controlled)
‚îú‚îÄ‚îÄ specweave/             ‚Üê CORE PLUGIN (framework essentials)
‚îÇ   ‚îú‚îÄ‚îÄ .claude-plugin/         ‚Üê plugin.json (Claude native)
‚îÇ   ‚îú‚îÄ‚îÄ skills/                 ‚Üê Core skills (9 total)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spec-generator/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ increment-planner/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tdd-workflow/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ agents/                 ‚Üê Core agents (3 core + 19 specialized)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pm/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architect/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tech-lead/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ commands/               ‚Üê Core commands (7 core + 15 specialized)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inc.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ do.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  ‚Üê Lifecycle hooks (8 total)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post-task-completion.sh
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pre-implementation.sh
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ lib/                    ‚Üê TypeScript utilities (optional)
‚îÇ
‚îî‚îÄ‚îÄ specweave-{name}/           ‚Üê Other plugins (GitHub, Figma, etc.)
    ‚îú‚îÄ‚îÄ .claude-plugin/         ‚Üê plugin.json (Claude native)
    ‚îú‚îÄ‚îÄ skills/                 ‚Üê Plugin skills
    ‚îú‚îÄ‚îÄ agents/                 ‚Üê Plugin agents
    ‚îú‚îÄ‚îÄ commands/               ‚Üê Plugin commands
    ‚îî‚îÄ‚îÄ lib/                    ‚Üê TypeScript utilities (optional)

.claude/                        ‚Üê INSTALLED (gitignored in user projects)
‚îú‚îÄ‚îÄ agents/                     ‚Üê Installed from plugins/*/agents/
‚îú‚îÄ‚îÄ commands/                   ‚Üê Installed from plugins/*/commands/
‚îú‚îÄ‚îÄ hooks/                      ‚Üê Installed from plugins/*/hooks/
‚îî‚îÄ‚îÄ skills/                     ‚Üê Installed from plugins/*/skills/

.specweave/                     ‚Üê FRAMEWORK DATA (always present)
‚îú‚îÄ‚îÄ increments/                 ‚Üê Feature development
‚îú‚îÄ‚îÄ docs/                       ‚Üê Strategic documentation
‚îî‚îÄ‚îÄ logs/                       ‚Üê Logs and execution history
```

**Rules**:
- ‚úÖ `src/` = TypeScript code ONLY (compiled to `dist/`)
- ‚úÖ ALL skills/agents/commands/hooks = Inside `plugins/` (including core!)
- ‚úÖ `plugins/specweave/` = Core framework plugin (always loaded)
- ‚úÖ Marketplace = GLOBAL via CLI (no per-project `.claude/` folder)
- ‚ùå NEVER mix `*.ts` and `SKILL.md` in the same directory
- ‚ùå NEVER create new files in project root (use increment folders)

**Key Architectural Principle**:
- TypeScript code (`*.ts`) goes in `src/` ‚Üí compiled to `dist/`
- Claude-native files (`SKILL.md`, `AGENT.md`, `*.md`) stay in `plugins/` ‚Üí loaded directly by Claude Code
- Even "core" framework components are in `plugins/specweave/` (everything is a plugin!)
- This separation ensures clean builds and prevents mixing compiled code with runtime files

### Tech Stack

**Core**:
- TypeScript 5.x (strict mode)
- Node.js 18+ (ESM + CommonJS)
- Commander.js (CLI framework)
- Inquirer.js (interactive prompts)
- fs-extra (file operations)

**Testing**:
- Playwright (E2E browser tests)
- Jest (unit + integration tests)
- ts-jest (TypeScript support)

**Documentation**:
- Docusaurus 3.x (docs-site/)
- Mermaid diagrams (architecture visualization)
- Markdown (all docs)

**Distribution**:
- NPM package (`npm publish`)
- Install script (`install.sh`)

---

## Directory Structure

```
specweave/
‚îú‚îÄ‚îÄ src/                        # SOURCE OF TRUTH (TypeScript code ONLY)
‚îÇ   ‚îú‚îÄ‚îÄ cli/                    # CLI commands (init, version)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commands/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ init.ts         # Main installation logic
‚îÇ   ‚îú‚îÄ‚îÄ core/                   # Core framework logic (TypeScript only)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plugin-loader.ts    # Load plugins from disk
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plugin-manager.ts   # Plugin lifecycle management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plugin-detector.ts  # Auto-detect plugins (4 phases)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config-manager.ts   # Config loading/validation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plugin.ts       # Plugin type definitions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ plugin-manifest.schema.json
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ specweave-config.schema.json
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  # TypeScript utilities for hooks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/                # Hook helper functions
‚îÇ   ‚îú‚îÄ‚îÄ adapters/               # Tool adapters (legacy)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adapter-interface.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adapter-base.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ claude/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cursor/ (legacy)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ generic/ (legacy)
‚îÇ   ‚îú‚îÄ‚îÄ templates/              # User project templates
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CLAUDE.md.template
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AGENTS.md.template
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ utils/                  # Utility functions
‚îÇ
‚îú‚îÄ‚îÄ plugins/                    # ALL PLUGINS (root level)
‚îÇ   ‚îú‚îÄ‚îÄ specweave/         # CORE PLUGIN (framework essentials)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plugin.json     # Claude native manifest
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ skills/             # Core skills (9 total)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spec-generator/         # Specification generation for increments
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ increment-planner/      # Increment planning and spec generation
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ context-loader/         # Context loading optimization
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tdd-workflow/           # Test-driven development workflow
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ project-kickstarter/    # New project bootstrapping
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ brownfield-analyzer/    # Existing codebase analysis
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ brownfield-onboarder/   # Brownfield project onboarding
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ increment-quality-judge/# Quality assessment
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ context-optimizer/      # Context optimization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agents/             # Core agents (22 total)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pm/             # Product Manager agent
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architect/      # System Architect agent
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tech-lead/      # Tech Lead agent
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/           # Core commands (22 total)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inc.md        # /specweave:inc
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ do.md         # /specweave:do
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ done.md       # /specweave:done
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/              # Lifecycle hooks (8 total)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post-task-completion.sh # Auto-runs after tasks complete
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pre-implementation.sh   # Pre-task validation
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/                # TypeScript utilities (optional)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ specweave-github/       # GitHub Issues integration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ plugin.json     # Claude native manifest
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ skills/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ github-sync/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ github-issue-tracker/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ github-manager/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ github-create-issue.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ github-sync.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/                # TypeScript utilities
‚îÇ   ‚îú‚îÄ‚îÄ specweave-figma/        # Figma design sync
‚îÇ   ‚îú‚îÄ‚îÄ specweave-infrastructure/ # K8s, Helm, Terraform
‚îÇ   ‚îî‚îÄ‚îÄ ... (18 plugins total)
‚îÇ
‚îú‚îÄ‚îÄ .claude-plugin/             # Claude Code marketplace (root level)
‚îÇ   ‚îú‚îÄ‚îÄ marketplace.json        # Plugin catalog (18 plugins)
‚îÇ   ‚îî‚îÄ‚îÄ README.md               # Marketplace documentation
‚îÇ
‚îú‚îÄ‚îÄ .claude/                    # Pre-installed for SpecWeave dev
‚îÇ   ‚îú‚îÄ‚îÄ agents/                 # Installed from plugins/*/agents/
‚îÇ   ‚îú‚îÄ‚îÄ commands/               # Installed from plugins/*/commands/
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                  # Installed from plugins/*/hooks/
‚îÇ   ‚îî‚îÄ‚îÄ skills/                 # Installed from plugins/*/skills/
‚îÇ
‚îú‚îÄ‚îÄ .specweave/                 # SpecWeave's own increments
‚îÇ   ‚îú‚îÄ‚îÄ increments/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 0001-core-framework/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 0002-core-enhancements/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spec.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plan.md
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.md        # Tasks with embedded tests (v0.7.0+)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logs/           # ‚úÖ Session logs go here
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ scripts/        # ‚úÖ Helper scripts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reports/        # ‚úÖ Analysis files
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _backlog/
‚îÇ   ‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ internal/           # Strategic docs (NEVER published) - 6 core folders
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ strategy/       # Business rationale, vision, PRDs, OKRs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ specs/          # Feature specifications (detailed requirements, project history)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ spec-###-{name}.md  # User stories, AC, implementation plans
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architecture/   # Technical design (HLD, LLD, ADR, diagrams)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adr/        # Architecture Decision Records (why we chose X over Y)
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ diagrams/   # Mermaid + SVG (C4 model diagrams)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ delivery/       # Build & release processes (roadmap, DORA, branching)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ operations/     # Production operations (runbooks, SLOs, incidents)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ governance/     # Policies (security, compliance, coding standards)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ public/             # User-facing docs (can publish)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ guides/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ logs/
‚îÇ
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ e2e/                    # Playwright E2E tests
‚îÇ   ‚îú‚îÄ‚îÄ integration/            # Integration tests
‚îÇ   ‚îú‚îÄ‚îÄ unit/                   # Unit tests
‚îÇ   ‚îî‚îÄ‚îÄ specs/                  # Test specifications
‚îÇ
‚îú‚îÄ‚îÄ bin/                        # Installation scripts
‚îÇ   ‚îú‚îÄ‚îÄ install-all.sh
‚îÇ   ‚îú‚îÄ‚îÄ install-skills.sh
‚îÇ   ‚îî‚îÄ‚îÄ install-agents.sh
‚îÇ
‚îú‚îÄ‚îÄ scripts/                    # Build/deployment scripts
‚îÇ   ‚îú‚îÄ‚îÄ install-brownfield.sh
‚îÇ   ‚îî‚îÄ‚îÄ generate-diagram-svgs.sh
‚îÇ
‚îú‚îÄ‚îÄ docs-site/                  # Docusaurus documentation site
‚îÇ
‚îú‚îÄ‚îÄ CLAUDE.md                   # This file (for contributors)
‚îú‚îÄ‚îÄ README.md                   # GitHub README (for users)
‚îú‚îÄ‚îÄ CHANGELOG.md                # Version history
‚îú‚îÄ‚îÄ package.json                # NPM package definition
‚îî‚îÄ‚îÄ tsconfig.json               # TypeScript configuration
```

---

## File Organization Rules

### ‚úÖ ALLOWED in Root

- `CLAUDE.md` (this file)
- `README.md`, `CHANGELOG.md`, `LICENSE`
- Standard config files (`package.json`, `tsconfig.json`, `.gitignore`)
- Build artifacts (`dist/`, only if needed temporarily)

### ‚ùå NEVER Create in Root (Pollutes Repository)

**See comprehensive rules at top of document**: [üö® CRITICAL: NEVER POLLUTE PROJECT ROOT!](#-critical-never-pollute-project-root)

**Quick summary**:
- ‚úÖ ALL AI-generated files ‚Üí increment folders (`.specweave/increments/####/reports/`, `logs/`, `scripts/`)
- ‚úÖ Architecture decisions ‚Üí `.specweave/docs/internal/architecture/adr/`
- ‚ùå NEVER create `.md` files, scripts, or logs in project root
- ‚ùå Build artifacts (`.tgz`, `.pt`, etc.) ‚Üí add to `.gitignore`

### Runtime Artifacts (NOT Source Controlled)

**Logs and ephemeral files** should NEVER be committed:

```
‚ùå NEVER COMMIT:
.specweave/logs/                        # Framework runtime logs
.specweave/logs/last-hook-fire          # Hook execution timestamps
.specweave/increments/*/logs/           # Increment execution logs
.specweave/cache/                       # Temporary cache
*.tmp                                   # Temporary files
```

**Why?**
- ‚úÖ Logs are execution artifacts, not source code
- ‚úÖ They change on every run (noise in git history)
- ‚úÖ They cause unnecessary merge conflicts
- ‚úÖ They bloat the repository over time
- ‚úÖ They're developer-specific, not shared state

**Enforcement**: `.gitignore` excludes these patterns automatically.

---

## Internal Documentation Structure

**Location**: `.specweave/docs/internal/` - Cross-project folders + multi-project organization

### Cross-Project Documentation (Top-Level)

**Five cross-project folders** apply to the entire system:

| Folder | Purpose | Use When | Examples |
|--------|---------|----------|----------|
| **strategy/** | Business rationale (Why?) | Defining business case for features | `prd-user-auth.md` |
| **architecture/** | System-wide technical design | Architecture affecting all projects | `hld-system.md`, `adr/0001-postgres.md` |
| **delivery/** | Build & release (How we build) | Git workflow, DORA metrics, CI/CD | `branch-strategy.md`, `dora-metrics.md` |
| **operations/** | Production ops (How we run) | Runbooks, incidents, performance | `runbook-api.md`, `performance-tuning.md` |
| **governance/** | Policies (Guardrails) | Security, compliance, coding standards | `security-policy.md`, `coding-standards.md` |

### Multi-Project Organization (v0.8.0+, Flattened v0.16.11+)

**FLATTENED STRUCTURE** (v0.16.11): Simpler, cleaner paths with document-type-first organization

```
.specweave/docs/internal/
‚îú‚îÄ‚îÄ strategy/              # Cross-project (unchanged)
‚îú‚îÄ‚îÄ architecture/          # System-wide ADRs (unchanged)
‚îú‚îÄ‚îÄ delivery/              # Cross-project (unchanged)
‚îú‚îÄ‚îÄ operations/            # Cross-project (unchanged)
‚îú‚îÄ‚îÄ governance/            # Cross-project (unchanged)
‚îÇ
‚îú‚îÄ‚îÄ specs/                 # ‚ú® FLATTENED: Living docs specs
‚îÇ   ‚îú‚îÄ‚îÄ default/           # Default project (single-project mode)
‚îÇ   ‚îú‚îÄ‚îÄ backend/           # Backend project
‚îÇ   ‚îú‚îÄ‚îÄ frontend/          # Frontend project
‚îÇ   ‚îî‚îÄ‚îÄ _parent/           # Parent repository (multi-repo setups)
‚îÇ
‚îú‚îÄ‚îÄ modules/               # ‚ú® FLATTENED: Module documentation
‚îÇ   ‚îú‚îÄ‚îÄ default/
‚îÇ   ‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îî‚îÄ‚îÄ frontend/
‚îÇ
‚îú‚îÄ‚îÄ team/                  # ‚ú® FLATTENED: Team playbooks
‚îÇ   ‚îú‚îÄ‚îÄ default/
‚îÇ   ‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îî‚îÄ‚îÄ frontend/
‚îÇ
‚îú‚îÄ‚îÄ project-arch/          # ‚ú® RENAMED: Project-specific ADRs
‚îÇ   ‚îú‚îÄ‚îÄ backend/           # (Renamed to avoid conflict with top-level architecture/)
‚îÇ   ‚îî‚îÄ‚îÄ frontend/
‚îÇ
‚îî‚îÄ‚îÄ legacy/                # ‚ú® FLATTENED: Brownfield imports
    ‚îú‚îÄ‚îÄ default/
    ‚îî‚îÄ‚îÄ backend/
```

**Benefits of Flattened Structure**:
- ‚úÖ Simpler paths (no extra `projects/` nesting)
- ‚úÖ Consistent with cross-project folders (all at same level)
- ‚úÖ Clearer parent repo naming (`_parent` for multi-repo)
- ‚úÖ Easier GitHub sync (shorter paths)
- ‚úÖ Document-type-first organization (group by specs/, modules/, etc.)

**Five Documentation Types Per Project**:

1. **specs/{project-id}/** - Living documentation specs (user stories, acceptance criteria)
   - Permanent, feature-level knowledge base
   - ALL user stories for a feature area
   - 3-digit numbers: `spec-001-user-auth.md`

2. **modules/{project-id}/** - Module/component documentation
   - Architecture, API contracts, integration guides
   - Created when module >1000 lines or has security implications
   - Example: `auth-module.md`, `payment-module.md`

3. **team/{project-id}/** - Team playbooks
   - Onboarding, conventions, workflows, contacts
   - Team-specific processes and practices
   - Example: `onboarding.md`, `conventions.md`, `workflows.md`

4. **project-arch/{project-id}/** - Project-specific ADRs (optional)
   - Decisions affecting only this project
   - Use top-level `architecture/` for system-wide decisions
   - Example: `adr/0001-use-postgres.md`

5. **legacy/{project-id}/** - Brownfield imports (temporary)
   - Imported from Notion, Confluence, Wiki
   - Migration report + classified files
   - Clean up after migration complete

**Key Architecture Principle**: Single project = multi-project with 1 project called "default" (NO special cases!)

**Document Flow**: `PRD ‚Üí Spec ‚Üí Architecture ‚Üí Delivery ‚Üí Operations`

**See**:
- [Internal Docs README](.specweave/docs/internal/README.md) for complete guidance
- [Multi-Project Setup Guide](.specweave/docs/public/guides/multi-project-setup.md) for usage
- [ADR-0017](/.specweave/docs/internal/architecture/adr/0017-multi-project-internal-structure.md) for architecture decisions

---

## Specs Architecture: Two Locations Explained

**CRITICAL ARCHITECTURAL CONCEPT**: SpecWeave uses specs in TWO locations for different purposes. Understanding this distinction is essential.

### The Core Question: Why Two Locations?

1. **Living Docs Specs**: `.specweave/docs/internal/specs/{project-id}/spec-NNN-feature-area.md` - **Permanent, feature-level knowledge base**
2. **Increment Specs**: `.specweave/increments/####-name/spec.md` - **Temporary, focused implementation snapshot**

**Key Difference**: Specs use **3-digit numbers** (001, 002, 003) for **feature areas**, increments use **4-digit numbers** (0001, 0002, 0003) for **implementations**.

### The Answer: Permanent vs Temporary

**Living Docs Specs = Permanent, Feature-Level Knowledge Base**

- **Location**: `.specweave/docs/internal/specs/default/spec-001-core-framework-architecture.md` (single project) or `.specweave/docs/internal/specs/web-app/spec-001-user-auth.md` (multi-project)
- **Purpose**: COMPLETE, PERMANENT source of truth for entire feature area
- **Lifecycle**: Created once, updated over time, NEVER deleted
- **Scope**: Comprehensive feature area (e.g., "Core Framework", 10-50 user stories)
- **Contains**:
  - ‚úÖ ALL user stories for the feature area (across multiple increments)
  - ‚úÖ ALL acceptance criteria for those user stories
  - ‚úÖ Implementation history (which increments implemented which parts)
  - ‚úÖ Links to brownfield documentation (existing project docs)
  - ‚úÖ External PM tool links (GitHub Project, Jira Epic, ADO Feature)
  - ‚úÖ Architecture decisions rationale (ADRs)
  - ‚úÖ Success criteria & metrics for the feature area

**Increment Specs = Temporary, Focused Implementation Snapshot**

- **Location**: `.specweave/increments/0001-core-framework/spec.md`
- **Purpose**: TEMPORARY implementation reference (what am I building THIS iteration?)
- **Lifecycle**: Created per increment, can be deleted after completion
- **Scope**: Focused subset (3-5 user stories for this increment only)
- **Contains**:
  - ‚úÖ Reference to living docs: `"See: SPEC-001-core-framework-architecture"`
  - ‚úÖ Subset of user stories: `"Implements: US-001, US-002, US-003 only"`
  - ‚úÖ What's being implemented RIGHT NOW (this iteration)
  - ‚úÖ Out of scope: Lists what's NOT in this increment (deferred to future increments)

### Real-World Example: SpecWeave Core Framework

**Living Docs Spec** (Permanent, Feature-Level):
```
File: .specweave/docs/internal/specs/default/spec-001-core-framework-architecture.md

# SPEC-001: Core Framework & Architecture
Foundation framework with CLI, plugin system, cross-platform support

## Increments (Implementation History)
- 0001-core-framework: MVP CLI, skills, agents (Complete)
- 0002-core-enhancements: Context optimization, PM agent (Complete)
- 0004-plugin-architecture: Claude native plugins (Complete)
- 0005-cross-platform-cli: Windows/Mac/Linux support (Complete)

## User Stories (35 total across all 4 increments)
- US-001: NPM installation (0001) ‚úÖ
- US-003: Context optimization (0002) ‚úÖ
- US-005: Plugin system (0004) ‚úÖ
- US-007: Cross-platform CLI (0005) ‚úÖ
... (31 more stories)

## External References
- GitHub Project: TBD (create for 1.0.0)
```

**Increment Spec** (Temporary, Implementation-Level):
```
File: .specweave/increments/0001-core-framework/spec.md

# Increment 0001: Core Framework MVP
**Implements**: SPEC-001-core-framework-architecture (US-001 to US-002 only)
**Complete Specification**: See ../../docs/internal/projects/default/specs/spec-001-core-framework-architecture.md

## What We're Implementing (This Increment Only)
- US-001: NPM installation + CLI basics ‚úÖ
- US-002: Plugin system foundation ‚úÖ

## Out of Scope (For This Increment)
- ‚ùå Context optimization (US-003) ‚Üí Increment 0002
- ‚ùå Claude native plugins (US-005) ‚Üí Increment 0004
- ‚ùå Cross-platform support (US-007) ‚Üí Increment 0005
```

### Key Benefits

**Why This Architecture?**

1. **Permanent Knowledge Base**: Living docs = long-term memory. Answer: "How did we build authentication?"
2. **Focused Implementation**: Increment specs = short-term focus. Answer: "What am I building RIGHT NOW?"
3. **Brownfield Integration**: Living docs link to existing project documentation, increment specs don't need this complexity
4. **Clean After Completion**: Delete increment specs (optional), living docs remain as knowledge base
5. **External PM Tool Integration**: Jira epic ‚Üí Living docs spec (permanent link), increment specs don't need external links

### When to Use Which?

**Create Living Docs Spec When**:
- ‚úÖ Planning a major feature (authentication, payments, messaging)
- ‚úÖ Feature spans multiple increments (will take weeks/months)
- ‚úÖ Need brownfield integration (link to existing project docs)
- ‚úÖ Want permanent historical record (how did we build this?)
- ‚úÖ Need external PM tool link (Jira epic, ADO feature, GitHub milestone)

**Create Increment Spec When**:
- ‚úÖ Starting implementation of one increment
- ‚úÖ Want quick reference (what am I building right now?)
- ‚úÖ Need focused scope (just 3 user stories, not 20)

### Comparison Table

| Aspect | Living Docs Specs | Increment Specs |
|--------|------------------|----------------|
| **Location** | `.specweave/docs/internal/specs/` | `.specweave/increments/####/` |
| **Lifecycle** | ‚úÖ Permanent (never deleted) | ‚è≥ Temporary (optional deletion) |
| **Scope** | üìö Complete feature (20 US) | üéØ Focused subset (3 US) |
| **Size** | 500+ lines (comprehensive) | 50-100 lines (focused) |
| **Purpose** | Knowledge base + history | Implementation tracker |
| **Coverage** | ALL user stories | SUBSET of user stories |
| **Brownfield** | ‚úÖ Links to existing docs | ‚ùå Rarely needed |
| **External Links** | ‚úÖ Jira, ADO, GitHub | ‚ùå Rarely needed |
| **Multiple Increments** | ‚úÖ One spec ‚Üí many increments | ‚ùå One increment ‚Üí one spec |
| **After Completion** | ‚úÖ Remains forever | ‚ö†Ô∏è Can be deleted |

### Analogy: Wikipedia vs Sticky Notes

- **Living Docs Specs** = üìö Wikipedia Article (permanent, comprehensive, updated over time)
- **Increment Specs** = üìù Sticky Note Reminder (temporary, focused, disposable after done)

### Typical Workflow

**Phase 1: Planning** (PM Agent)
```
User: "I want to build a plugin-based framework with CLI"
PM Agent:
1. Creates living docs spec:
   ‚Üí .specweave/docs/internal/specs/spec-001-core-framework-architecture.md
   ‚Üí Contains ALL 35 user stories (comprehensive, feature-level)
   ‚Üí Links to GitHub Project (TBD)
   ‚Üí Maps to 4 increments (0001, 0002, 0004, 0005)
```

**Phase 2: Increment 1** (Core MVP)
```
User: "/specweave:increment 0001-core-framework"
PM Agent:
1. Creates increment spec:
   ‚Üí .specweave/increments/0001-core-framework/spec.md
   ‚Üí References living docs: "See SPEC-001"
   ‚Üí Contains ONLY US-001 to US-002 (focused, this iteration only)
2. Implementation happens...
3. Increment completes ‚úÖ
4. Increment spec stays for history (or can be deleted)
```

**Phase 3: Increment 2** (Enhancements)
```
User: "/specweave:increment 0002-core-enhancements"
PM Agent:
1. Creates increment spec:
   ‚Üí .specweave/increments/0002-core-enhancements/spec.md
   ‚Üí References SAME living docs: "See SPEC-001"
   ‚Üí Contains ONLY US-003 to US-004 (focused, this iteration only)
2. Implementation happens...
3. Increment completes ‚úÖ
```

**Phase 4: All Increments Done!**
```
After ALL increments complete (0001, 0002, 0004, 0005):
- ‚úÖ Living docs spec REMAINS (permanent knowledge base)
- ‚è≥ Increment specs can be deleted (optional cleanup)
- ‚úÖ Complete history preserved in spec-001
- ‚úÖ GitHub Project linked to SPEC-001 (not increments)
```

### Relationship

**One living docs spec ‚Üí Many increment specs**

```
SPEC-001: Core Framework & Architecture (Living Docs - Permanent, Feature-Level)
‚îú‚îÄ‚îÄ 0001-core-framework (Increment - Temporary, Implementation-Level)
‚îú‚îÄ‚îÄ 0002-core-enhancements (Increment - Temporary, Implementation-Level)
‚îú‚îÄ‚îÄ 0004-plugin-architecture (Increment - Temporary, Implementation-Level)
‚îî‚îÄ‚îÄ 0005-cross-platform-cli (Increment - Temporary, Implementation-Level)

SPEC-002: Intelligent AI Capabilities (Living Docs - Permanent, Feature-Level)
‚îú‚îÄ‚îÄ 0003-intelligent-model-selection (Increment - Temporary, Implementation-Level)
‚îú‚îÄ‚îÄ 0007-smart-increment-discipline (Increment - Temporary, Implementation-Level)
‚îî‚îÄ‚îÄ 0009-intelligent-reopen-logic (Increment - Temporary, Implementation-Level)
```

### Summary

**Two Locations, Two Purposes**:

1. **Living Docs Specs** (`.specweave/docs/internal/specs/`):
   - ‚úÖ Permanent knowledge base
   - ‚úÖ Complete feature specification
   - ‚úÖ Links to brownfield docs
   - ‚úÖ External PM tool integration
   - ‚úÖ Spans multiple increments

2. **Increment Specs** (`.specweave/increments/####/`):
   - ‚è≥ Temporary implementation tracker
   - üéØ Focused subset of work
   - üìù Quick reference: "What am I building?"
   - üóëÔ∏è Can be deleted after completion

**Result**: Clean, focused implementation + permanent knowledge base

**For comprehensive explanation**: See [SPECS-ARCHITECTURE-CLARIFICATION.md](.specweave/increments/0007-smart-increment-discipline/reports/SPECS-ARCHITECTURE-CLARIFICATION.md)

---

## Enterprise Specs Organization (Domain-Based)

**NEW in v0.20.0**: Living docs specs organized by feature domain with rich metadata and auto-generated indices.

### The Problem with Flat Structure

**Before** (v0.19.x and earlier):
```
.specweave/docs/internal/specs/default/
‚îú‚îÄ‚îÄ spec-001-core-framework-architecture.md
‚îú‚îÄ‚îÄ spec-002-intelligent-capabilities.md
‚îú‚îÄ‚îÄ spec-003-developer-experience.md
... (30+ files in one folder)
‚îú‚îÄ‚îÄ nfr-risks.md
‚îú‚îÄ‚îÄ nfr-configuration-example.md
‚îú‚îÄ‚îÄ overview-overview.md
‚îî‚îÄ‚îÄ us-us1-single-provider-setup.md
```

**Problems**:
- ‚ùå 30+ files in single folder (hard to navigate)
- ‚ùå Mixed document types (specs, NFRs, overviews, user stories)
- ‚ùå No categorization by feature area
- ‚ùå Poor scalability (becomes unmanageable at 100+ specs)
- ‚ùå No rich metadata (status, priority, ownership)

### Enterprise Solution: Domain-Based Organization

**After** (v0.20.0+):
```
.specweave/docs/internal/specs/default/
‚îú‚îÄ‚îÄ core-framework/              # Domain folder
‚îÇ   ‚îú‚îÄ‚îÄ README.md                # Domain overview
‚îÇ   ‚îú‚îÄ‚îÄ spec-001-*.md           # Feature specs
‚îÇ   ‚îú‚îÄ‚îÄ spec-004-*.md
‚îÇ   ‚îú‚îÄ‚îÄ nfrs/                    # NFRs for this domain
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ nfr-cross-platform.md
‚îÇ   ‚îî‚îÄ‚îÄ user-stories/            # Extracted user stories
‚îÇ       ‚îî‚îÄ‚îÄ us-001-*.md
‚îÇ
‚îú‚îÄ‚îÄ developer-experience/
‚îÇ   ‚îú‚îÄ‚îÄ spec-003-*.md
‚îÇ   ‚îú‚îÄ‚îÄ spec-022-*.md
‚îÇ   ‚îî‚îÄ‚îÄ user-stories/
‚îÇ
‚îú‚îÄ‚îÄ integrations/
‚îÇ   ‚îú‚îÄ‚îÄ github/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ spec-017-sync-fix.md
‚îÇ   ‚îú‚îÄ‚îÄ jira/
‚îÇ   ‚îî‚îÄ‚îÄ ado/
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/
‚îÇ   ‚îú‚îÄ‚îÄ spec-004-metrics.md
‚îÇ   ‚îú‚îÄ‚îÄ spec-029-cicd-failure.md
‚îÇ   ‚îî‚îÄ‚îÄ nfrs/
‚îÇ
‚îú‚îÄ‚îÄ quality-velocity/
‚îÇ   ‚îú‚îÄ‚îÄ spec-005-stabilization.md
‚îÇ   ‚îî‚îÄ‚îÄ spec-010-dora-metrics.md
‚îÇ
‚îú‚îÄ‚îÄ intelligence/
‚îÇ   ‚îú‚îÄ‚îÄ spec-002-intelligent-capabilities.md
‚îÇ   ‚îú‚îÄ‚îÄ spec-016-self-reflection.md
‚îÇ   ‚îî‚îÄ‚îÄ spec-009-intelligent-reopen.md
‚îÇ
‚îî‚îÄ‚îÄ _index/                      # Auto-generated indices
    ‚îú‚îÄ‚îÄ README.md                # Master index
    ‚îú‚îÄ‚îÄ by-status.md             # Active, planning, completed, archived
    ‚îú‚îÄ‚îÄ by-domain.md             # All domains
    ‚îú‚îÄ‚îÄ by-release.md            # 1.0.0, 1.1.0, 2.0.0
    ‚îú‚îÄ‚îÄ by-priority.md           # P0, P1, P2, P3
    ‚îî‚îÄ‚îÄ by-team.md               # Core Team, Platform Team, etc.
```

### Six Feature Domains

| Domain | Description | Examples |
|--------|-------------|----------|
| **core-framework** | Core framework capabilities | CLI, plugin architecture, configuration, lifecycle |
| **developer-experience** | DX improvements | Setup, onboarding, docs, error messages, usability |
| **integrations** | External tool integrations | GitHub, JIRA, Azure DevOps, Figma, Slack |
| **infrastructure** | Platform, DevOps, ops | CI/CD, monitoring, observability, performance |
| **quality-velocity** | Testing, metrics, releases | Testing framework, DORA metrics, stabilization |
| **intelligence** | AI-powered features | Model selection, self-reflection, smart workflows |

### Rich Metadata for Every Spec

Every spec gets YAML frontmatter with comprehensive metadata:

```yaml
---
# Identity
id: spec-001-core-framework-architecture
title: "Core Framework & Architecture"
version: 2.0
status: active | planning | completed | archived

# Classification
domain: core-framework
category: feature | nfr | user-story | overview
priority: P0 | P1 | P2 | P3
complexity: low | medium | high | very-high

# Ownership
team: Core Team
owner: @anton-abyzov
stakeholders: ["Product", "Engineering"]

# Lifecycle
created: 2025-01-15
last_updated: 2025-11-10
target_release: 1.0.0

# Relationships
increments: [0001, 0002, 0004, 0005]
depends_on: []
blocks: [spec-002, spec-003]
related: [spec-016]

# External Links
github_project: https://github.com/anton-abyzov/specweave/projects/1
jira_epic: null
confluence: null

# Tags
tags: [framework, cli, plugin-system, mvp]

# Metrics
estimated_effort: 120h
actual_effort: 95h
user_stories: 35
completion: 100%
---
```

### Auto-Generated Navigation Indices

**Five index views** for different navigation needs:

1. **by-status.md** - Status-based view
   - Active (currently being worked on)
   - Planning (being planned)
   - Completed (delivered to production)
   - Archived (historical reference)

2. **by-domain.md** - Domain-based view
   - Core Framework (5 specs)
   - Developer Experience (3 specs)
   - Integrations (4 specs)
   - Infrastructure (3 specs)
   - Quality & Velocity (2 specs)
   - Intelligence (3 specs)

3. **by-release.md** - Release planning view
   - 1.0.0 (MVP release)
   - 1.1.0 (Post-launch improvements)
   - 2.0.0 (Major features)
   - Unscheduled (backlog)

4. **by-priority.md** - Priority-based view
   - P0 (Critical, security, production blockers)
   - P1 (High, MVPessential, core features)
   - P2 (Medium, nice-to-have, enhancements)
   - P3 (Low, future, backlog, deferred)

5. **by-team.md** - Team ownership view
   - Core Team
   - Platform Team
   - DX Team
   - Integrations Team

### Automated Classification

**Intelligent Living Docs Sync** auto-classifies specs by domain using keyword matching:

```typescript
// Auto-classification during living docs sync
const classifyDomain = (spec: string): string => {
  const keywords = {
    'core-framework': ['framework', 'cli', 'plugin', 'core', 'foundation'],
    'developer-experience': ['dx', 'ux', 'installation', 'setup', 'guide'],
    'integrations': ['github', 'jira', 'ado', 'figma', 'sync'],
    'infrastructure': ['cicd', 'monitoring', 'observability', 'performance'],
    'quality-velocity': ['testing', 'dora', 'metrics', 'stabilization'],
    'intelligence': ['ai', 'intelligent', 'smart', 'reflection', 'model']
  };

  // Score each domain and return highest
  // Confidence threshold: 0.5 (50% keyword match)
};
```

### PM Agent Instructions

**CRITICAL**: When creating living docs specs, PM agent MUST:

1. **Classify Domain** - Determine feature domain based on content
2. **Add Rich Metadata** - Include all required frontmatter fields
3. **Use Correct Path** - Save to domain-specific folder
4. **Generate README** - Update domain README.md
5. **Regenerate Indices** - Run index generation after creating spec

**Example PM Agent Workflow**:

```typescript
// Step 1: Classify domain
const domain = classifyDomain(spec.title, spec.content);
// Result: "core-framework"

// Step 2: Determine path
const specPath = `.specweave/docs/internal/specs/default/${domain}/spec-001-core-framework.md`;

// Step 3: Add frontmatter
const frontmatter = {
  id: 'spec-001-core-framework-architecture',
  title: 'Core Framework & Architecture',
  domain: 'core-framework',
  category: 'feature',
  priority: 'P1',
  status: 'active',
  team: 'Core Team',
  owner: '@anton-abyzov',
  created: '2025-11-12',
  target_release: '1.0.0',
  tags: ['framework', 'cli', 'plugin']
};

// Step 4: Write spec with frontmatter
writeSpec(specPath, frontmatter, content);

// Step 5: Update domain README
updateDomainReadme(domain, spec);

// Step 6: Regenerate indices
regenerateIndices();
```

### Migration Scripts

**Three scripts for migration**:

1. **Classify Specs** (`scripts/classify-specs.ts`)
   - Scans existing specs
   - Auto-classifies by domain (keyword matching)
   - Generates classification report
   - Saves classification.json for migration

2. **Migrate to Domains** (`scripts/migrate-specs-to-domains.ts`)
   - Reads classification.json
   - Creates domain folders
   - Moves specs to domain-specific folders
   - Adds/updates frontmatter
   - Creates domain READMEs
   - Supports --dry-run mode

3. **Generate Indices** (`scripts/generate-spec-indices.ts`)
   - Scans all specs
   - Generates 5 navigation indices
   - Creates master index (README.md)
   - Shows statistics

**Usage**:

```bash
# Step 1: Classify existing specs
npx ts-node scripts/classify-specs.ts
# Output: classification-report.md, classification.json

# Step 2: Review classification
vim .specweave/docs/internal/specs/default/_index/classification-report.md

# Step 3: Migrate (dry-run first)
npx ts-node scripts/migrate-specs-to-domains.ts --dry-run

# Step 4: Migrate (actual)
npx ts-node scripts/migrate-specs-to-domains.ts

# Step 5: Generate indices
npx ts-node scripts/generate-spec-indices.ts
```

### Benefits

**For Users**:
- ‚úÖ Find specs 10x faster (browse by domain vs scroll through 30+ files)
- ‚úÖ Clear relationships (dependencies, blockers, related specs)
- ‚úÖ Rich metadata (status, priority, ownership, effort)
- ‚úÖ Multi-dimensional navigation (status, domain, release, team, priority)

**For Teams**:
- ‚úÖ Team ownership (core-team/, platform-team/)
- ‚úÖ Release planning (1.0.0, 1.1.0, 2.0.0)
- ‚úÖ Dependency management (blocks[], depends_on[])
- ‚úÖ Effort tracking (estimated_effort vs actual_effort)

**For Enterprise**:
- ‚úÖ Scalability (handles 100+ specs easily)
- ‚úÖ Compliance (audit trail via metadata)
- ‚úÖ Reporting (auto-generated indices for stakeholders)
- ‚úÖ Multi-project (backend/, frontend/, mobile/)

### Configuration

Add to `.specweave/config.json`:

```json
{
  "specs": {
    "organization": {
      "strategy": "domain-based",
      "autoDomainClassification": true,
      "autoGenerateIndices": true,
      "requireMetadata": true,
      "domains": [
        "core-framework",
        "developer-experience",
        "integrations",
        "infrastructure",
        "quality-velocity",
        "intelligence"
      ],
      "metadata": {
        "required": ["id", "title", "status", "domain", "team", "owner"],
        "optional": ["priority", "complexity", "tags", "increments"]
      }
    }
  }
}
```

### For Agents and Skills

**PM Agent MUST**:
1. Always classify domain before creating spec
2. Add rich frontmatter with all required fields
3. Save to correct domain folder (not flat structure)
4. Update domain README after creating spec
5. Regenerate indices after spec creation

**Living Docs Sync MUST**:
1. Detect domain from increment spec content
2. Place spec in correct domain folder
3. Add/update frontmatter with metadata
4. Preserve existing classification if present
5. Regenerate indices after sync

**See**:
- [Organization Strategy](.specweave/docs/internal/specs/ORGANIZATION-STRATEGY.md) - Complete architecture
- Migration scripts in `scripts/` directory
- Configuration in `.specweave/config.json`

---

## Living Completion Reports

### The Problem with Traditional Reports

**Traditional approach** (report written at the end):
```
Start increment: Plan 10 user stories
During work: Scope changes 5 times (not documented)
End increment: Write report "Completed 8/10 stories"
Future: "Why was Story 5 removed?" ‚Üí No one remembers!
```

**Problems**:
- ‚ùå No audit trail for scope changes
- ‚ùå Decision rationale lost
- ‚ùå Difficult for onboarding/compliance
- ‚ùå Can't learn from past iterations

### Living Reports Solution

**SpecWeave approach** (report updated in real-time):
```
Start: Initialize completion report (v1.0)
During work:
  - 2025-11-06: Added US6 (dark mode) ‚Üí /update-scope ‚Üí v1.1
  - 2025-11-07: Deferred US3 (CSV export) ‚Üí /update-scope ‚Üí v1.2
  - 2025-11-08: WebSockets ‚Üí Polling pivot ‚Üí /update-scope ‚Üí v1.3
End: Finalize report with complete scope evolution history
Future: "Why was Story 5 removed?" ‚Üí Check report, find exact reason with WHO approved and WHY!
```

**Benefits**:
- ‚úÖ Complete audit trail (every scope change documented)
- ‚úÖ Real-time context (captured when decision is fresh)
- ‚úÖ Regulatory compliance (explains deviations from plan)
- ‚úÖ Learning for future increments
- ‚úÖ Onboarding new team members (understand project history)

### Report Structure

**Location**: `.specweave/increments/{id}/reports/COMPLETION-REPORT.md`

**Sections**:
1. **Original Scope**: What was planned at increment start
2. **Scope Evolution**: Living log of changes (updated during increment)
3. **Final Delivery**: What was actually delivered
4. **What Changed and Why**: Rationale for scope changes
5. **Lessons Learned**: What we learned for next time
6. **Metrics**: Velocity, scope creep, test coverage, defects

### Workflow

**1. Initialize Report** (automatic when increment created):
```bash
/specweave:increment "User dashboard"
# Creates: .specweave/increments/0008-user-dashboard/reports/COMPLETION-REPORT.md (v1.0)
```

**2. Update During Work** (whenever scope changes):
```bash
# Quick log
/specweave:update-scope "Added dark mode toggle (stakeholder request from CMO, +16 hours)"

# Or interactive
/specweave:update-scope
# Prompts:
#   - What changed? (Added/Removed/Modified)
#   - Why? (Business reason, technical blocker, etc.)
#   - Impact? (+/- hours)
#   - Who approved? (PM, stakeholder, etc.)
#   - Documentation? (ADR, GitHub issue, etc.)
```

**3. Finalize at Completion** (via `/specweave:done`):
```bash
/specweave:done 0008
# Validates report completeness
# Prompts to fill any missing sections
# Marks increment as complete
```

### Example Entry

```markdown
## Scope Evolution (Living Updates)

### 2025-11-06: Added user story

**Changed**: US6: Dark mode toggle
**Reason**: Stakeholder request from CMO (high priority, blocks marketing launch)
**Impact**: +16 hours
**Decision**: PM + CMO
**Documentation**: GitHub issue #45

---

### 2025-11-07: Removed/deferred user story

**Changed**: US3: Data export to CSV
**Reason**: Not critical for MVP, can be added later without breaking changes
**Impact**: -8 hours (deferred to increment 0009)
**Decision**: PM
**Documentation**: None

---

### 2025-11-08: Technical pivot (architecture change)

**Changed**: WebSockets ‚Üí Long-polling
**Reason**: WebSocket library had critical security vulnerability (CVE-2025-1234)
**Impact**: -4 hours (simpler implementation)
**Decision**: Architect + Security Lead
**Documentation**: ADR-008: Why We Chose Polling Over WebSockets

---
```

### When to Update

‚úÖ **DO update** when:
- Adding new user story or task
- Removing/deferring work
- Modifying scope of existing story
- Making architecture pivots (technical decisions)
- Reducing/expanding scope
- Blocking issues discovered

‚ùå **DON'T update** for:
- Bug fixes discovered during implementation (normal)
- Minor implementation details
- Code refactoring (unless scope-affecting)

### Best Practices

1. **Update in real-time**: Don't batch updates (capture context while fresh)
2. **Be specific**: "Added US6: Dark mode" not "Added feature"
3. **Include rationale**: Always answer WHY
4. **Link to docs**: ADR, GitHub issue, Jira ticket
5. **Track approvals**: Who made the decision
6. **Quantify impact**: +/- hours for scope changes

### Commands

| Command | Purpose |
|---------|---------|
| `/specweave:increment "feature"` | Creates increment with initial completion report |
| `/specweave:update-scope` | Log scope change during increment |
| `/specweave:done <id>` | Finalize report and mark increment complete |

**See**: [update-scope.md](plugins/specweave/commands/update-scope.md) for detailed documentation

---

## Development Workflow

### Making Changes

**ALL components belong to plugins** (following [Claude Code's plugin system](https://docs.claude.com/en/docs/claude-code/plugins)).

**1. Editing Skills** (any plugin):
```bash
# Core plugin (auto-loaded):
vim plugins/specweave/skills/spec-generator/SKILL.md

# Other plugins (opt-in):
vim plugins/specweave-github/skills/github-sync/SKILL.md

# Skills auto-activate based on description keywords
```

**2. Editing Agents** (any plugin):
```bash
# Core plugin (auto-loaded):
vim plugins/specweave/agents/pm/AGENT.md

# Other plugins (opt-in):
vim plugins/specweave-github/agents/github-manager/AGENT.md

# Test by invoking via Task tool
```

**3. Editing Commands** (any plugin):
```bash
# Core plugin (auto-loaded):
vim plugins/specweave/commands/do.md

# Other plugins (opt-in):
vim plugins/specweave-github/commands/github-sync.md

# Test via /command-name
```

**4. Creating New Plugins** (see "Plugins" section below for complete instructions)

**5. Editing Framework Code** (`src/core/`, `src/cli/`):
```bash
# Edit TypeScript (config manager, plugin loader, etc.)
vim src/core/config-manager.ts

# Build and test
npm run build && npm test
```

### Testing Strategy

**Four Levels of Testing** (mirroring SpecWeave's philosophy):

1. **Specification Tests** (`.specweave/docs/internal/strategy/`)
   - Acceptance criteria in PRDs
   - Manual validation

2. **Embedded Tests** (`.specweave/increments/####/tasks.md`)
   - Test plans embedded in tasks (BDD format, v0.7.0+)
   - AC-ID traceability (AC-US1-01, AC-US1-02, etc.)

3. **Integration Tests** (`tests/integration/{skill-name}/`)
   - Tests for plugin and skill functionality
   - Tool sync (github, ado, jira)
   - Brownfield detection and other integrations
   - Run via: `npm run test:integration`

4. **Code Tests** (`tests/`)
   - **E2E (Playwright)**: MANDATORY for UI features
     - `tests/e2e/specweave-smoke.spec.ts`
     - Run: `npm run test:e2e`
   - **Integration**: Tool sync, brownfield detection
     - `tests/integration/`
     - Run: `npm run test:integration`
   - **Unit**: Core logic, config parsing
     - `tests/unit/`
     - Run: `npm test`

**Coverage Requirements**:
- Critical paths: 90%+
- Overall: 80%+
- Tests MUST tell the truth (no false positives)

### Hooks and Automation

## üéØ CRITICAL: How Claude Code Hooks Actually Work

**Official Docs**: https://code.claude.com/docs/en/hooks

### The Correct Architecture (Plugin-Based Hooks)

**Hooks live in the PLUGIN, not in `.claude/hooks/`!**

```
plugins/specweave/
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ plugin.json              ‚Üê "hooks": "./hooks/hooks.json"
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ hooks.json               ‚Üê Hook configuration (references .sh files)
‚îÇ   ‚îú‚îÄ‚îÄ post-task-completion.sh  ‚Üê Stays here (NOT copied!)
‚îÇ   ‚îî‚îÄ‚îÄ post-increment-planning.sh
‚îî‚îÄ‚îÄ ...
```

**Key Facts**:
1. ‚úÖ **Hooks stay in plugins/** - They are NOT copied to `.claude/hooks/`
2. ‚úÖ **hooks.json references them** - Uses `${CLAUDE_PLUGIN_ROOT}/hooks/post-task-completion.sh`
3. ‚úÖ **Automatic discovery** - Claude Code reads plugin's hooks.json at startup
4. ‚úÖ **Runtime merging** - Plugin hooks merge with user/project hooks automatically
5. ‚úÖ **SpecWeave doesn't use `.claude/`** - Plugin hooks live in `plugins/`, but users CAN add custom hooks to `.claude/settings.json`

### Hook Discovery Flow

```
1. Plugin installed:
   /plugin install specweave

2. Claude Code startup:
   Reads: plugins/specweave/.claude-plugin/plugin.json
   ‚Üì
   Discovers: "hooks": "./hooks/hooks.json"
   ‚Üì
   Loads: plugins/specweave/hooks/hooks.json
   ‚Üì
   Registers: PostToolUse ‚Üí TodoWrite ‚Üí ${CLAUDE_PLUGIN_ROOT}/hooks/post-task-completion.sh

3. Hook execution:
   TodoWrite completes
   ‚Üì
   Claude Code executes: plugins/specweave/hooks/post-task-completion.sh
   ‚Üì
   Hook runs!
```

**NO copying needed!** `${CLAUDE_PLUGIN_ROOT}` resolves to the plugin directory automatically.

### What `.claude/` Actually Contains

**SpecWeave doesn't create it!** But users can create `.claude/settings.json` for custom hooks/settings.

**Why SpecWeave doesn't create `.claude/`:**
- Marketplace registration is GLOBAL via CLI (`claude plugin marketplace add`)
- No per-project settings.json needed for SpecWeave
- No hook files needed (hooks come from plugins, not project)
- Cleaner project structure

**Valid uses of `.claude/` folder:**
- ‚úÖ User-defined custom hooks (`.claude/settings.json`)
- ‚úÖ Project-specific hook configurations
- ‚úÖ Local settings (`.claude/settings.local.json`)

**If you see `.claude/settings.json`** created by SpecWeave in your project:
- It's from an older version of SpecWeave (<v0.14.0)
- Safe to delete - marketplace is already registered globally
- Won't affect functionality

### What `.specweave/config.json` Contains

**THIS is where hook behavior is configured**:
```json
{
  "hooks": {
    "post_task_completion": {
      "sync_living_docs": true,        // ‚úÖ Enables living docs sync
      "sync_tasks_md": true,           // ‚úÖ Updates tasks.md
      "external_tracker_sync": true    // ‚úÖ Syncs to GitHub/Jira/ADO
    }
  },
  "sync": {
    "enabled": true,
    "activeProfile": "github-default",
    "profiles": {
      "github-default": {
        "provider": "github",
        "config": {
          "owner": "anton-abyzov",
          "repo": "specweave"
        }
      }
    }
  }
}
```

Hooks READ this config to know:
- Whether sync is enabled
- Which provider to sync to (GitHub/Jira/ADO)
- Owner/repo or domain/project info

### Summary: What Makes Hooks Work

| Component | Location | Purpose |
|-----------|----------|---------|
| **Hook scripts** | `plugins/specweave/hooks/*.sh` | Actual executable code |
| **Hook config** | `plugins/specweave/hooks/hooks.json` | Registers hooks with Claude |
| **Plugin manifest** | `plugins/specweave/.claude-plugin/plugin.json` | Points to hooks.json |
| **Marketplace** | GLOBAL (via CLI) | Plugin discovery (NOT per-project!) |
| **Behavior config** | `.specweave/config.json` | Hook behavior settings |

**Bottom line**: Hooks are a **plugin feature**, not a project feature. They work via plugin installation (GLOBAL), not file copying!

**For detailed hook documentation**, see:
- **Plugin Hook Documentation**: `plugins/specweave/hooks/README.md` - How hooks work, configuration, testing
- **Official Claude Code Docs**: https://code.claude.com/docs/en/hooks - Native hook system reference

---

**Post-Task Completion Hook** (`plugins/specweave/hooks/post-task-completion.sh`):

**Smart Session-End Detection**:
- ‚úÖ Tracks inactivity gaps between TodoWrite calls
- ‚úÖ Only plays sound when session is TRULY ending (15s+ inactivity after all tasks complete)
- ‚úÖ Skips sound during rapid work (Claude creating multiple todo lists)
- ‚úÖ Enhanced logging with decision reasoning in `.specweave/logs/hooks-debug.log`
- ‚úÖ Debouncing prevents duplicate hook fires

**How It Works**:
```
Problem: Claude creates multiple todo lists in one conversation
- List 1: [A, B, C] ‚Üí completes ‚Üí sound plays ‚ùå
- List 2: [D, E] ‚Üí completes 30s later ‚Üí sound plays again ‚ùå
- User hears sounds while Claude is still working!

Solution: Inactivity-based detection
- 10:00:00 - Task done (gap: 5s) ‚Üí skip sound
- 10:00:05 - Task done (gap: 5s) ‚Üí skip sound
- 10:00:10 - All done (gap: 5s) ‚Üí skip sound (rapid work)
- ... (15+ seconds pass)
- 10:01:00 - All done (gap: 50s) ‚Üí PLAY SOUND! ‚úÖ (session ending)
```

**Configuration** (`src/hooks/post-task-completion.sh`):
- `INACTIVITY_THRESHOLD=15` - Seconds of inactivity to assume session ending (adjustable)
- `DEBOUNCE_SECONDS=2` - Prevents duplicate hook fires

**Pre-Tool-Use Hook** (`.claude/hooks/pre-tool-use.sh`):

**Purpose**: Detect when Claude asks questions BEFORE task completion

**The Problem**: The post-task-completion hook only fires after TodoWrite events. If Claude asks a question via AskUserQuestion WITHOUT completing any tasks first, no sound plays and the user doesn't know Claude is waiting for input.

**The Solution**: The pre-tool-use hook fires BEFORE every tool call, allowing us to detect AskUserQuestion immediately.

**How It Works**:
```
Scenario 1: Question after task completion
- 10:00:00 - Task completed (TodoWrite) ‚Üí post-task-completion hook fires
- 10:00:15 - Inactivity threshold reached ‚Üí SOUND! ‚úÖ

Scenario 2: Question WITHOUT task completion (NEW!)
- 10:00:00 - Claude calls AskUserQuestion ‚Üí pre-tool-use hook fires
- 10:00:00 - Detects tool_name="AskUserQuestion" ‚Üí SOUND! ‚úÖ
- User is notified IMMEDIATELY, not after 15s
```

**Key Features**:
- ‚úÖ Fires BEFORE any tool call (PreToolUse event)
- ‚úÖ Filters for AskUserQuestion specifically
- ‚úÖ Plays distinctive sound (Tink.aiff on macOS, dialog-question.oga on Linux)
- ‚úÖ Non-blocking and fast (<10ms overhead)
- ‚úÖ Complements post-task-completion hook (both work together)

**Result**: Users are ALWAYS notified when Claude needs input, regardless of whether tasks have been completed or not.

**Manual Actions** (Claude MUST do after each task):
- Update `CLAUDE.md` when structure changes
- Update `README.md` for user-facing changes
- Update `CHANGELOG.md` for API changes

**Living Docs Sync** (AUTOMATIC after task completion):

**The Critical Problem**: `.specweave/docs/internal/specs/` is the **permanent source of truth** for ALL completed work across the entire enterprise. Without automatic sync, this documentation becomes stale and incomplete.

**How It Works** (Automatic):
1. **Hook Triggers**: After every task completion (TodoWrite), `post-task-completion.sh` fires
2. **Sync Check**: Runs `dist/hooks/lib/sync-living-docs.js` to check if sync is needed
3. **Automatic Sync**: If enabled in config, syncs increment specs to living docs
4. **Result**: `.specweave/docs/internal/specs/spec-{id}.md` is always up-to-date

**Configuration** (`.specweave/config.json`):
```json
{
  "hooks": {
    "post_task_completion": {
      "sync_living_docs": true,        // ‚úÖ MUST be true!
      "sync_tasks_md": true,           // Updates tasks.md with completion status
      "external_tracker_sync": true    // Syncs to GitHub/Jira/ADO
    }
  }
}
```

**Manual Sync** (when automatic sync was disabled):
```bash
# Sync all completed increments to living docs
/specweave:sync-docs update

# Or copy manually (emergency only):
cp .specweave/increments/0001-core-framework/spec.md \
   .specweave/docs/internal/specs/spec-0001-core-framework.md
```

**Verify Sync**:
```bash
# Check all synced specs
ls -1 .specweave/docs/internal/specs/spec-*.md

# Should match number of completed increments
ls -1 .specweave/increments/ | grep -E '^[0-9]{4}' | wc -l
```

**Why This Matters**:
- ‚úÖ **Enterprise-level traceability**: Every increment's spec is permanently archived
- ‚úÖ **Cross-increment history**: See all work completed across the entire project
- ‚úÖ **Onboarding new developers**: Read specs to understand what was built and why
- ‚úÖ **Compliance & auditing**: Complete audit trail of all product decisions
- ‚úÖ **Living documentation**: Specs stay up-to-date without manual intervention

**üß† INTELLIGENT LIVING DOCS SYNC (v0.18.0+)**

**Two Sync Modes**:

1. **Simple Mode** (Legacy):
   - Copies entire `spec.md` to living docs as single file
   - Location: `.specweave/docs/internal/specs/spec-{id}.md`
   - Use when: Single project, simple workflow

2. **Intelligent Mode** (NEW in v0.18.0+):
   - Parses spec.md into sections
   - Classifies content (user stories, architecture, ADRs, operations, etc.)
   - Detects project (backend/frontend/mobile)
   - Distributes to appropriate folders
   - Generates cross-links
   - Adds Docusaurus frontmatter

**Enable Intelligent Mode** (`.specweave/config.json`):
```json
{
  "hooks": {
    "post_task_completion": {
      "sync_living_docs": true
    }
  },
  "livingDocs": {
    "intelligent": {
      "enabled": true,
      "splitByCategory": true,
      "generateCrossLinks": true,
      "preserveOriginal": true,
      "classificationConfidenceThreshold": 0.6,
      "fallbackProject": "default"
    }
  }
}
```

**Result** (Intelligent Mode):
```
‚úÖ BEFORE (Simple Mode):
.specweave/docs/internal/specs/spec-0016-authentication.md  (5,000 lines, mixed content)

‚úÖ AFTER (Intelligent Mode):
.specweave/docs/internal/
‚îú‚îÄ‚îÄ specs/backend/
‚îÇ   ‚îú‚îÄ‚îÄ us-001-backend-api-auth.md        (User Story + Docusaurus frontmatter)
‚îÇ   ‚îú‚îÄ‚îÄ us-002-session-management.md      (User Story + Cross-links)
‚îÇ   ‚îú‚îÄ‚îÄ _archive/spec-0016-authentication.md  (Original preserved)
‚îÇ   ‚îî‚îÄ‚îÄ README.md                         (Auto-generated project index)
‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îú‚îÄ‚îÄ authentication-flow.md            (HLD)
‚îÇ   ‚îî‚îÄ‚îÄ adr/0001-oauth-vs-jwt.md          (ADR)
‚îú‚îÄ‚îÄ operations/
‚îÇ   ‚îú‚îÄ‚îÄ runbook-auth-service.md           (Runbook)
‚îÇ   ‚îî‚îÄ‚îÄ slo-auth-availability.md          (SLO)
‚îú‚îÄ‚îÄ delivery/
‚îÇ   ‚îî‚îÄ‚îÄ test-strategy-authentication.md   (Test Strategy)
‚îî‚îÄ‚îÄ strategy/
    ‚îî‚îÄ‚îÄ auth-business-requirements.md     (Business Requirements)
```

**Classification System** (9 Categories):

| Category | Detects | Goes To |
|----------|---------|---------|
| **User Story** | US-XXX pattern, "As a" format, AC | `specs/{project}/` |
| **NFR** | NFR-XXX pattern, metrics, SLAs | `specs/{project}/nfr/` |
| **Architecture** | HLD, LLD, diagrams | `architecture/` |
| **ADR** | ADR-XXX pattern, decision structure | `architecture/adr/` |
| **Operations** | Runbooks, SLOs | `operations/` |
| **Delivery** | Test strategy, release plans | `delivery/` |
| **Strategy** | Business requirements, PRDs | `strategy/` |
| **Governance** | Security, compliance | `governance/` |
| **Overview** | Summaries | `specs/{project}/` |

**Project Detection** (Multi-Project Support):

Intelligent sync detects which project (backend/frontend/mobile) via:
- Increment name contains project ID (e.g., `0016-backend-auth`) ‚Üí +10 points
- Frontmatter `project:` field ‚Üí +20 points (highest)
- Team name match ‚Üí +5 points
- Keyword match ‚Üí +3 points each
- Tech stack match ‚Üí +2 points each

**Example**:
```yaml
---
title: User Authentication
project: backend    # ‚Üê Explicit project (100% confidence)
---

# User Authentication

Quick overview: Implement OAuth for **backend services** using Node.js...
# Keywords: backend, service, Node.js ‚Üí detected!
```

**Multi-Project Setup** (`.specweave/config.json`):
```json
{
  "multiProject": {
    "projects": {
      "backend": {
        "name": "Backend Services",
        "keywords": ["api", "backend", "service"],
        "techStack": ["Node.js", "PostgreSQL"]
      },
      "frontend": {
        "name": "Frontend App",
        "keywords": ["ui", "frontend", "react"],
        "techStack": ["React", "Next.js"]
      }
    }
  }
}
```

**Result**: Content distributed to `specs/backend/` and `specs/frontend/` automatically!

**Docusaurus Frontmatter** (Auto-Generated):

Every distributed file gets rich frontmatter for LLM context:

```yaml
---
id: us-001-user-login
title: "US-001: User Login"
sidebar_label: "User Login"
description: "User can log in with email and password"
tags: ["user-story", "backend", "authentication"]
increment: "0016-authentication"
project: "backend"                    # ‚Üê LLM knows which project
category: "user-story"                # ‚Üê LLM knows document type
last_updated: "2025-11-10"
status: "planning"
priority: "P1"
---
```

**Cross-Linking** (Bidirectional):

Intelligent sync generates "Related Documents" sections:

```markdown
## Related Documents

### Implements
- [Authentication Architecture](../../architecture/auth-flow.md)

### References
- [ADR-001: OAuth vs JWT](../../architecture/adr/0001-oauth-vs-jwt.md)

### Defined In
- [Business Requirements](../../strategy/auth-requirements.md)
```

**Benefits of Intelligent Mode**:
- ‚úÖ **Better organization**: Content organized by type and project
- ‚úÖ **Easier navigation**: Find docs quickly (specs vs architecture vs operations)
- ‚úÖ **LLM-friendly**: Rich context (project, category, tags) for AI assistants
- ‚úÖ **Cross-linked**: Related documents automatically connected
- ‚úÖ **Docusaurus-ready**: Frontmatter works out-of-the-box
- ‚úÖ **Multi-project**: Separate docs for backend/frontend/mobile
- ‚úÖ **Traceability**: Footer shows source increment and last updated

**Performance**:
- Fast: ~10-50ms to parse, classify, and distribute
- Async: Runs in background (non-blocking)
- Fallback: Falls back to simple mode on error

**User Guide**: `.specweave/docs/public/guides/intelligent-living-docs-sync.md`
**Architecture**: `.specweave/docs/internal/architecture/adr/0030-intelligent-living-docs-sync.md`

---

**üîß HOOKS ARCHITECTURE CHANGES (v0.13.0)**

**What Changed**: External tool sync logic (GitHub, JIRA, Azure DevOps) has been **moved from core plugin to respective plugin hooks** to follow Claude Code's native plugin architecture.

**Before (v0.12.x)**:
```
Core hook: plugins/specweave/hooks/post-task-completion.sh (452 lines)
‚îú‚îÄ‚îÄ Core concerns (sound, living docs, translation)
‚îú‚îÄ‚îÄ GitHub sync (107 lines)    ‚Üê Embedded in core!
‚îú‚îÄ‚îÄ JIRA sync (11 lines)        ‚Üê Embedded in core!
‚îî‚îÄ‚îÄ Azure DevOps sync (11 lines) ‚Üê Embedded in core!
```

**After (v0.13.0+)**:
```
Core hook: plugins/specweave/hooks/post-task-completion.sh (330 lines)
‚îú‚îÄ‚îÄ Core concerns ONLY (sound, living docs, translation, reflection)

GitHub plugin: plugins/specweave-github/hooks/post-task-completion.sh (241 lines)
‚îú‚îÄ‚îÄ GitHub API calls, issue updates, progress comments

JIRA plugin: plugins/specweave-jira/hooks/post-task-completion.sh (150 lines)
‚îú‚îÄ‚îÄ JIRA API calls, issue status updates

ADO plugin: plugins/specweave-ado/hooks/post-task-completion.sh (150 lines)
‚îú‚îÄ‚îÄ Azure DevOps API calls, work item updates
```

**Benefits**:
- ‚úÖ **27% smaller core hook** (452 ‚Üí 330 lines)
- ‚úÖ **No external tool dependencies** in core plugin (no gh CLI, JIRA API, ADO API)
- ‚úÖ **Optional plugins** (GitHub sync only runs if `specweave-github` installed)
- ‚úÖ **Independent testing** (test each hook in isolation)
- ‚úÖ **Parallel execution** (Claude Code runs all hooks concurrently)

**How Claude Code's Hook System Works**:
1. Task completes ‚Üí `TodoWrite` tool fires
2. Claude Code triggers `PostToolUse` event
3. **ALL registered plugin hooks fire in parallel**:
   - Core hook: Sound + Living docs + Translation + Reflection
   - GitHub hook: Update issue checkboxes (if installed)
   - JIRA hook: Update issue status (if installed)
   - ADO hook: Update work item (if installed)

**Key Insight**: Each plugin registers its own hooks via `hooks.json`, enabling clean modularity and separation of concerns.

**Migration**: No action needed! Existing increments with GitHub/JIRA/ADO links will continue to sync automatically.

**Documentation**:
- **Architecture Analysis**: `.specweave/increments/0018-strict-increment-discipline-enforcement/reports/HOOKS-ARCHITECTURE-ANALYSIS.md`
- **Core Plugin Hooks**: `plugins/specweave/hooks/README.md`
- **GitHub Plugin Hooks**: `plugins/specweave-github/hooks/README.md`
- **JIRA Plugin Hooks**: `plugins/specweave-jira/hooks/README.md`
- **ADO Plugin Hooks**: `plugins/specweave-ado/hooks/README.md`

---

**Post-Increment-Planning Hook** (AUTOMATIC after `/specweave:increment`):

**GitHub Issue Auto-Creation** (NEW in v0.8.20+):

**The Critical Problem**: Without automatic GitHub issue creation, increments don't sync to GitHub automatically. This requires manual `/specweave-github:create-issue` calls, which are often forgotten.

**The Solution**: The `post-increment-planning.sh` hook now auto-creates GitHub issues immediately after increment planning completes.

**How It Works** (Automatic):
1. **Hook Triggers**: After `/specweave:increment` completes planning (spec.md, plan.md, tasks.md created)
2. **Auto-Create Check**: Checks if `config.sync.settings.autoCreateIssue` is enabled
3. **GitHub CLI Available**: Verifies `gh` CLI is installed and authenticated
4. **Issue Creation**:
   - Extracts title from spec.md frontmatter (`title: "..."`)
   - Extracts summary from "Quick Overview" section
   - Generates task checklist from tasks.md (all tasks as GitHub checkboxes)
   - Calls `gh issue create` with proper labels (`specweave`, `increment`)
   - Parses output to get issue number
5. **Metadata Update**: Creates/updates `.metadata.json` with GitHub issue number and URL
6. **Result**: Increment is now linked to GitHub issue for bidirectional sync!

**Configuration** (`.specweave/config.json`):
```json
{
  "sync": {
    "settings": {
      "autoCreateIssue": true,  // ‚úÖ Enable auto-creation!
      "syncDirection": "bidirectional"
    },
    "activeProfile": "specweave-dev",
    "profiles": {
      "specweave-dev": {
        "provider": "github",
        "config": {
          "owner": "anton-abyzov",
          "repo": "specweave"
        }
      }
    }
  }
}
```

**What Gets Created**:
```markdown
# [INC-0016] AI Self-Reflection System

**Status**: Planning ‚Üí Implementation
**Priority**: P1
**Increment**: 0016-self-reflection-system

## Summary

Add AI self-reflection capabilities inspired by Kimi model...

## Tasks

Progress: 0/30 tasks (0%)

- [ ] T-001: Create Reflection Configuration Schema
- [ ] T-002: Create Configuration Loader
- [ ] T-003: Create Git Diff Analyzer
... (all 30 tasks)

## Links

- **Spec**: `spec.md`
- **Plan**: `plan.md`
- **Tasks**: `tasks.md`

---

ü§ñ Auto-created by SpecWeave | Updates automatically on task completion
```

**Error Handling** (Robust):
- ‚úÖ **Missing files**: Graceful fallback if spec.md or tasks.md missing
- ‚úÖ **Title extraction**: Multiple fallbacks (frontmatter ‚Üí heading ‚Üí increment ID)
- ‚úÖ **Overview extraction**: Tries "Quick Overview", "Summary", or first paragraph
- ‚úÖ **Task count**: Extracts from frontmatter or counts tasks
- ‚úÖ **GitHub CLI failures**: Non-blocking (logs error, continues)
- ‚úÖ **Duplicate prevention**: Checks metadata.json for existing issue number
- ‚úÖ **Repository detection**: Auto-detects from git remote or config

**Manual Override** (When Needed):
```bash
# Disable auto-create for one increment
# Just don't set autoCreateIssue in config

# Or create manually if auto-create failed
/specweave-github:create-issue 0016

# Check if issue was created
cat .specweave/increments/0016-self-reflection-system/metadata.json
# Should show: "github": {"issue": 30, "url": "..."}
```

**Why This Matters**:
- ‚úÖ **Zero manual work**: Issues auto-create on every increment
- ‚úÖ **Immediate tracking**: Increment linked to GitHub from start
- ‚úÖ **Bidirectional sync**: Task completion updates GitHub automatically
- ‚úÖ **Team visibility**: Stakeholders see progress in GitHub without asking
- ‚úÖ **Audit trail**: All increments tracked in one place
- ‚úÖ **DORA metrics**: Automatic deployment frequency tracking

**Workflow Example**:
```bash
# 1. Create increment
/specweave:increment "AI self-reflection system"

# 2. Hook auto-fires:
# üîó Checking GitHub issue auto-creation...
#   üì¶ Auto-create enabled, checking for GitHub CLI...
#   ‚úì GitHub CLI found
#   üöÄ Creating GitHub issue for 0016-self-reflection-system...
#   üìù Issue #30 created
#   üîó https://github.com/anton-abyzov/specweave/issues/30
#   ‚úÖ metadata.json updated

# 3. Start work
/specweave:do

# 4. Complete tasks ‚Üí GitHub updates automatically via post-task-completion hook!
```

**Requirements**:
- GitHub CLI (`gh`) installed and authenticated (`gh auth login`)
- Repository with GitHub remote configured
- `autoCreateIssue: true` in config.json
- Write permissions to repository

---

**‚úÖ Metadata Validation & Fallback Creation** (NEW in v0.14.0+):

**The Problem**: Hook failures (no GitHub CLI, network issues, permission problems) left increments without metadata.json, breaking status line, WIP limits, and external sync.

**The Solution**: Multi-layer validation ensures 100% metadata.json coverage.

**How It Works**:

**Layer 1: Hook Fallback** (Automatic)
- After GitHub issue creation (success or fail)
- Hook validates metadata.json exists
- If missing ‚Üí creates minimal metadata automatically
- User sees warning + manual fix instructions

```bash
# Hook output example (GitHub CLI not found):
üîó Checking GitHub issue auto-creation...
  ‚ö†Ô∏è  GitHub CLI (gh) not found, skipping issue creation

üîç Validating metadata.json existence...
  ‚ö†Ô∏è  metadata.json not found (hook may have failed)
  üìù Creating minimal metadata as fallback...
  ‚úÖ Created minimal metadata.json
  ‚ö†Ô∏è  Note: No GitHub issue linked
  üí° Run /specweave-github:create-issue 0023-feature to create one manually
```

**Layer 2: PM Agent Validation** (Automatic)
- PM agent checks metadata.json after creating spec/plan/tasks
- If missing ‚Üí creates minimal metadata + warns user
- Shows GitHub issue status (linked or not)

```markdown
‚úÖ Increment validation passed - metadata.json exists
   ‚úÖ GitHub issue #45 linked
   üîó https://github.com/anton-abyzov/specweave/issues/45
```

**Layer 3: Lazy Initialization** (Fallback)
- `MetadataManager.read()` creates metadata on first access
- Used by `/specweave:status`, `/pause`, `/resume` commands
- Creates basic metadata but WITHOUT GitHub info

**Minimal Metadata Format** (when GitHub fails):
```json
{
  "id": "0023-release-management-enhancements",
  "status": "active",
  "type": "feature",
  "created": "2025-11-11T15:43:00Z",
  "lastActivity": "2025-11-11T15:43:00Z"
}
```

**Full Metadata Format** (when GitHub succeeds):
```json
{
  "id": "0016-self-reflection-system",
  "status": "active",
  "type": "feature",
  "created": "2025-11-10T12:00:00Z",
  "lastActivity": "2025-11-10T12:00:00Z",
  "github": {
    "issue": 30,
    "url": "https://github.com/anton-abyzov/specweave/issues/30",
    "synced": "2025-11-10T12:00:00Z"
  },
  "githubProfile": "specweave-dev"
}
```

**Benefits**:
- ‚úÖ **100% coverage**: Every increment gets metadata.json (no silent failures)
- ‚úÖ **Immediate feedback**: User knows if GitHub issue creation failed
- ‚úÖ **Graceful degradation**: Creates minimal metadata as fallback
- ‚úÖ **Clear next steps**: Shows manual fix command if needed
- ‚úÖ **Status line works**: Even without GitHub integration
- ‚úÖ **WIP limits work**: Counts active increments correctly

**Configuration Note**:

The old config key `hooks.post_increment_planning.auto_create_github_issue` is **deprecated** (v0.14.0+).

```json
{
  "hooks": {
    "post_increment_planning": {
      // ‚ùå REMOVED (deprecated)
      // "auto_create_github_issue": false
    }
  },
  "sync": {
    "settings": {
      "autoCreateIssue": true  // ‚úÖ Use this instead
    }
  }
}
```

**Single source of truth**: `sync.settings.autoCreateIssue`

---

## Status Line Feature (Increment Progress Display)

**NEW in v0.14.0**: Ultra-fast status line showing current increment progress with intelligent caching.

**Quick Summary**:
- ‚úÖ **<1ms render time** - Lightning-fast cache-based display
- ‚úÖ **Automatic updates** - Hook pre-computes after each task
- ‚úÖ **Multi-window support** - Shared cache across windows
- ‚úÖ **External edit detection** - mtime-based invalidation
- ‚úÖ **Visual enforcement** - Shows most recent increment (enforces 1-active discipline)

**Example Output**:
```bash
[sync-fix] ‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 15/30 (50%) ‚Ä¢ T-016: Update docs
```

**For complete architecture, configuration, and implementation details**: See [Status Line Feature](https://spec-weave.com/docs/learn/status-line) (comprehensive guide with performance benchmarks, multi-window scenarios, and code examples)

---

## Plugins

**SpecWeave is built 100% on [Claude Code's native plugin system](https://docs.claude.com/en/docs/claude-code/plugins)**.

### Architecture: Everything is a Plugin

**Critical Understanding**: SpecWeave doesn't have a "core framework" separate from plugins. Instead:

```
SpecWeave = Collection of Claude Code Plugins
‚îú‚îÄ‚îÄ specweave (auto-installed) ‚Üê The "framework" IS a plugin
‚îú‚îÄ‚îÄ specweave-github (auto-installed)
‚îú‚îÄ‚îÄ specweave-figma (auto-installed)
‚îî‚îÄ‚îÄ ...all 19+ plugins (auto-installed)
```

**What this means**:
- ‚úÖ `specweave` is a Claude Code plugin (happens to auto-load)
- ‚úÖ All plugins follow identical structure (`.claude-plugin/plugin.json`, `skills/`, `agents/`, `commands/`)
- ‚úÖ Adding a skill = adding it to a plugin (always)
- ‚ùå There are NO "core framework components" outside plugins

**Why this matters**:
- Uniform architecture (no special cases)
- All plugins discoverable via Claude Code's plugin system
- Easy to extend (just add another plugin)
- Future-proof (follows Anthropic's standards)

**Further reading**:
- üìñ [Claude Code Plugin Docs](https://docs.claude.com/en/docs/claude-code/plugins)
- üìñ [Plugin Reference](https://docs.claude.com/en/docs/claude-code/plugins-reference)
- üìñ [Plugin Marketplaces](https://docs.claude.com/en/docs/claude-code/plugin-marketplaces)

### Available SpecWeave Plugins

**Location**: `plugins/` (root level)

**Discovery**:
- Browse all plugins: `ls plugins/` or check [.claude-plugin/marketplace.json](/.claude-plugin/marketplace.json)
- Live catalog: See `.claude-plugin/README.md` for current marketplace contents
- **All plugins automatically installed** during `specweave init` (no manual selection needed)

**Plugin Structure** (all follow same pattern):
```
plugins/specweave-{name}/
‚îú‚îÄ‚îÄ .claude-plugin/plugin.json  # Claude native manifest
‚îú‚îÄ‚îÄ skills/                     # Auto-activating capabilities (SKILL.md files)
‚îú‚îÄ‚îÄ agents/                     # Specialized AI agents (AGENT.md files)
‚îú‚îÄ‚îÄ commands/                   # Slash commands (.md files)
‚îî‚îÄ‚îÄ lib/                        # TypeScript utilities (optional)
```

**Key Plugins** (for reference - all auto-installed):
- `specweave` - Framework essentials
- `specweave-github` - GitHub Issues integration
- `specweave-{frontend|backend|infrastructure}` - Tech stack plugins

**For complete list**: Check `plugins/` directory or marketplace.json

### Plugin Decision Tree

**Key Insight**: In Claude Code's plugin system, EVERYTHING is a plugin. The only question is: **Which plugin does this belong to?**

**Decision**: Which plugin should contain this feature?

```
Is this feature...
‚îú‚îÄ Used by EVERY project? ‚Üí specweave (auto-loaded)
‚îÇ  Examples: increment-planner, spec-generator, tdd-workflow, PM/Architect agents
‚îÇ
‚îú‚îÄ Part of increment lifecycle? ‚Üí specweave (auto-loaded)
‚îÇ  Examples: /specweave:increment, /specweave:do, living docs hooks
‚îÇ
‚îú‚îÄ Tech stack specific? ‚Üí New plugin: specweave-{stack}
‚îÇ  Examples: specweave-frontend (React, Next.js), specweave-kubernetes
‚îÇ
‚îú‚îÄ Domain expertise? ‚Üí New plugin: specweave-{domain}
‚îÇ  Examples: specweave-ml (TensorFlow), specweave-payments (Stripe)
‚îÇ
‚îú‚îÄ External integration? ‚Üí New plugin: specweave-{tool}
‚îÇ  Examples: specweave-github, specweave-jira, specweave-figma
‚îÇ
‚îî‚îÄ Optional enhancement? ‚Üí New plugin: specweave-{feature}
   Examples: specweave-diagrams, specweave-cost-optimizer
```

**Plugin Structure** (all follow Claude Code's standard):
```
plugins/specweave-{name}/
‚îú‚îÄ‚îÄ .claude-plugin/plugin.json  # Required
‚îú‚îÄ‚îÄ skills/                     # Optional
‚îú‚îÄ‚îÄ agents/                     # Optional
‚îú‚îÄ‚îÄ commands/                   # Optional
‚îî‚îÄ‚îÄ hooks/                      # Optional
```

**Result**: Core plugin stayed at ~12K tokens (75% smaller than v0.3.7!)

### Plugin Manifest Validation Rules

**CRITICAL**: Claude Code enforces strict validation on plugin.json manifests. Follow these rules to avoid loading errors:

#### Required Format

```json
{
  "name": "specweave-plugin-name",
  "description": "What it does and when to use it",
  "version": "1.0.0",
  "author": {
    "name": "Author Name",
    "url": "https://example.com"
  },
  "repository": "https://github.com/owner/repo",
  "homepage": "https://example.com",
  "license": "MIT",
  "keywords": ["keyword1", "keyword2"]
}
```

#### Validation Rules

| Field | Type | Rules | Example |
|-------|------|-------|---------|
| **name** | string | Required, lowercase, hyphens only | `"specweave-github"` |
| **description** | string | Required, max 1024 chars | `"GitHub integration..."` |
| **version** | string | Required, semver format | `"1.0.0"` |
| **author** | object | Required, with name field | `{"name": "Team"}` |
| **repository** | string | Must be string, NOT object | `"https://github.com/..."` ‚úÖ |
| **keywords** | array | Optional, array of strings | `["github", "sync"]` |
| **homepage** | string | Optional, URL | `"https://spec-weave.com"` |
| **license** | string | Optional, SPDX identifier | `"MIT"` |

#### Common Validation Errors

**‚ùå repository: Expected string, received object**
```json
// WRONG
"repository": {
  "type": "git",
  "url": "https://github.com/..."
}

// CORRECT
"repository": "https://github.com/..."
```

**‚ùå Unrecognized key(s): 'engines', 'dependencies'**
```json
// WRONG - These are NPM fields, not Claude plugin fields
"engines": {"node": ">=18.0.0"},
"dependencies": {"specweave": ">=0.14.0"}

// CORRECT - Omit these fields entirely
// Claude plugins don't support dependency declaration
```

**‚ùå skills/agents/commands: Invalid input**
```json
// WRONG - Directory references not supported in plugin.json
"skills": "skills",
"agents": "agents",
"commands": "commands"

// CORRECT - Omit these fields entirely
// Claude Code auto-discovers skills/, agents/, commands/ by convention
```

#### Auto-Discovery vs Explicit Declaration

**Claude Code auto-discovers components by directory convention**:
- `skills/` directory ‚Üí auto-discovered (no plugin.json field needed)
- `agents/` directory ‚Üí auto-discovered (no plugin.json field needed)
- `commands/` directory ‚Üí auto-discovered (no plugin.json field needed)
- `hooks/hooks.json` ‚Üí auto-discovered (no plugin.json field needed)

**Example: Working plugin.json**
```json
{
  "name": "specweave-github",
  "description": "GitHub integration",
  "version": "1.0.0",
  "author": {"name": "SpecWeave Team"},
  "repository": "https://github.com/anton-abyzov/specweave",
  "license": "MIT",
  "keywords": ["github", "sync"]
}
```

**Directory structure** (auto-discovered):
```
plugins/specweave-github/
‚îú‚îÄ‚îÄ .claude-plugin/
‚îÇ   ‚îî‚îÄ‚îÄ plugin.json          ‚Üê Plugin metadata only
‚îú‚îÄ‚îÄ skills/                  ‚Üê Auto-discovered
‚îÇ   ‚îî‚îÄ‚îÄ github-sync/
‚îú‚îÄ‚îÄ agents/                  ‚Üê Auto-discovered
‚îÇ   ‚îî‚îÄ‚îÄ github-manager/
‚îú‚îÄ‚îÄ commands/                ‚Üê Auto-discovered
‚îÇ   ‚îî‚îÄ‚îÄ github-sync.md
‚îî‚îÄ‚îÄ hooks/
    ‚îú‚îÄ‚îÄ hooks.json           ‚Üê Auto-discovered
    ‚îî‚îÄ‚îÄ post-task-completion.sh
```

#### Quick Validation Checklist

Before committing a new plugin:
- [ ] repository is a string, not an object
- [ ] No NPM-specific fields (engines, dependencies)
- [ ] No directory references in plugin.json (skills, agents, commands, hooks)
- [ ] Valid JSON syntax (use `jq . < plugin.json` to validate)
- [ ] Test with: `/plugin marketplace add ./.claude-plugin && /plugin install plugin-name`

### Adding a New Plugin (Contributors)

**Create New Plugin**:
```bash
# 1. Create plugin structure
mkdir -p plugins/specweave-myplugin/{.claude-plugin,skills,agents,commands,lib}

# 2. Create plugin.json (Claude native format)
cat > plugins/specweave-myplugin/.claude-plugin/plugin.json << 'EOF'
{
  "name": "specweave-myplugin",
  "description": "What it does and when to use it",
  "version": "1.0.0",
  "author": {"name": "Your Name"},
  "repository": "https://github.com/anton-abyzov/specweave",
  "homepage": "https://spec-weave.com",
  "license": "MIT",
  "keywords": ["specweave", "plugin"]
}
EOF

# 3. Add components (see Claude docs for format):
# - skills/my-skill/SKILL.md
# - agents/my-agent/AGENT.md
# - commands/my-command.md
# - lib/my-utility.ts (optional)

# 4. Add to marketplace
vim .claude-plugin/marketplace.json
# Add entry:
# {
#   "name": "specweave-myplugin",
#   "description": "What it does and when to use it",
#   "source": "../plugins/specweave-myplugin"
# }

# 5. Test locally
/plugin marketplace add ./.claude-plugin
/plugin install specweave-myplugin
```

**See**: [.claude-plugin/README.md](/.claude-plugin/README.md) for marketplace documentation

---

## Multi-Project Sync Architecture

**SpecWeave supports syncing increments to unlimited external repositories** (GitHub, JIRA, Azure DevOps) with intelligent rate limiting and time range filtering.

### üéØ CRITICAL: Source of Truth Architecture

**The Hub is LOCAL**, not external!

```
‚úÖ CORRECT Architecture:
.specweave/docs/specs/  ‚Üî  GitHub Issues       (Local ‚Üî External)
.specweave/docs/specs/  ‚Üî  Jira Epics          (Local ‚Üî External)
.specweave/docs/specs/  ‚Üî  Azure DevOps Items  (Local ‚Üî External)

‚ùå WRONG (External-to-External):
GitHub  ‚Üî  Jira                                 (External ‚Üî External - NO!)
GitHub PRs  ‚Üî  Jira Features                    (External ‚Üî External - NO!)
```

**Key Principle**: `.specweave/` is the **permanent source of truth**. External tools (GitHub, Jira, ADO) are **MIRRORS** of this truth.

**Sync Direction**:
- **Bidirectional** (default): Local ‚Üî External (changes sync both ways)
- **Export only**: Local ‚Üí External (push changes from Local to External)
- **Import only**: External ‚Üí Local (pull changes from External to Local)

### Core Concepts

**3-Layer Architecture**:

```
Layer 1: Credentials (.env)
‚îú‚îÄ‚îÄ GITHUB_TOKEN=...
‚îú‚îÄ‚îÄ JIRA_API_TOKEN=...
‚îî‚îÄ‚îÄ AZURE_DEVOPS_PAT=...

Layer 2: Sync Profiles (config.json)
‚îú‚îÄ‚îÄ specweave-dev (GitHub: anton-abyzov/specweave)
‚îú‚îÄ‚îÄ client-mobile (GitHub: client-org/mobile-app)
‚îú‚îÄ‚îÄ internal-jira (JIRA: company.atlassian.net/PROJ)
‚îî‚îÄ‚îÄ ado-backend (ADO: myorg/backend-services)

Layer 3: Per-Increment Metadata (metadata.json)
‚îî‚îÄ‚îÄ 0004-plugin-architecture
    ‚îú‚îÄ‚îÄ profile: specweave-dev
    ‚îú‚îÄ‚îÄ issueNumber: 130
    ‚îî‚îÄ‚îÄ timeRange: 1M
```

### Sync Profiles

**Profiles** define how to connect to external systems:

```json
{
  "sync": {
    "profiles": {
      "specweave-dev": {
        "provider": "github",
        "displayName": "SpecWeave Development",
        "config": {
          "owner": "anton-abyzov",
          "repo": "specweave"
        },
        "timeRange": {
          "default": "1M",
          "max": "6M"
        },
        "rateLimits": {
          "maxItemsPerSync": 500,
          "warnThreshold": 100
        }
      }
    }
  }
}
```

**Benefits**:
- ‚úÖ Unlimited profiles per provider (3+, 5+, 10+ repos)
- ‚úÖ Different increments sync to different repos
- ‚úÖ Team-based organization (Frontend ‚Üí repo-A, Backend ‚Üí repo-B)
- ‚úÖ Multi-client support (Client-A, Client-B, Client-C)

### Project Contexts

**Projects** organize work into logical groups:

```json
{
  "sync": {
    "projects": {
      "specweave-core": {
        "id": "specweave-core",
        "name": "SpecWeave Core",
        "description": "Core framework development",
        "keywords": ["framework", "cli", "plugin"],
        "team": "Core Team",
        "defaultSyncProfile": "specweave-dev",
        "specsFolder": ".specweave/docs/internal/specs/specweave-core",
        "increments": ["0001-core-framework", "0002-core-enhancements"]
      }
    }
  }
}
```

**Smart Project Detection**:
- Project name match: +10 points
- Team name match: +5 points
- Keyword match: +3 points per keyword
- Auto-select if confidence > 0.7

**Example**:
```
Increment: "Add React Native dark mode for mobile app"
‚Üí Detects project "mobile-app" (keywords: mobile, react-native)
‚Üí Uses profile "client-mobile" automatically
‚Üí Syncs to client-org/mobile-app repo
```

### Time Range Filtering

**Problem**: Syncing ALL data takes 25+ minutes and hits rate limits.

**Solution**: Time range presets filter data by creation date:

| Preset | Duration | Items | API Calls | Duration | Impact |
|--------|----------|-------|-----------|----------|--------|
| **1W** | 1 week | ~50 | 75 | 30 sec | Low |
| **1M** | 1 month | ~200 | 300 | 2 min | Medium (‚úÖ Recommended) |
| **3M** | 3 months | ~600 | 900 | 5 min | Medium |
| **6M** | 6 months | ~1,200 | 1,800 | 10 min | High |
| **ALL** | All time | ~5,000+ | 7,500+ | 30+ min | Critical (‚ùå Avoid) |

**Usage**:
```bash
# Interactive (select time range)
/specweave-github:sync 0004

# Specify time range
/specweave-github:sync 0004 --time-range 1M

# Preview before executing
/specweave-github:sync 0004 --dry-run
```

### Rate Limiting Protection

**Pre-Flight Validation**:
1. Estimate API calls based on time range
2. Check current rate limit status (GitHub: 5000/hour, JIRA: 100/min, ADO: 200/5min)
3. Calculate impact: low (<250 calls), medium (250-1000), high (1000-2500), critical (2500+)
4. Warn or block if risky

**Example: Critical Impact Blocked**:
```
‚ùå This sync may FAIL due to:

Blockers:
   ‚Ä¢ CRITICAL rate limit impact: 7,500 API calls exceeds safe threshold
   ‚Ä¢ Not enough rate limit remaining (need 7,500, only 4,850 remaining)

Recommendations:
   1. Reduce time range to 1 month (~300 API calls, SAFE)
   2. Wait for rate limit reset (25 minutes)
   3. Split sync across multiple time periods
```

### File Organization

**Specs organized by project**:
```
.specweave/docs/internal/specs/
‚îú‚îÄ‚îÄ specweave-core/
‚îÇ   ‚îú‚îÄ‚îÄ spec-001-core-framework.md
‚îÇ   ‚îî‚îÄ‚îÄ spec-002-plugin-architecture.md
‚îú‚îÄ‚îÄ client-mobile/
‚îÇ   ‚îú‚îÄ‚îÄ spec-001-mvp.md
‚îÇ   ‚îî‚îÄ‚îÄ spec-002-dark-mode.md
‚îî‚îÄ‚îÄ internal-backend/
    ‚îî‚îÄ‚îÄ spec-001-api-v2.md
```

### Key Files

**Core Infrastructure**:
- `src/core/types/sync-profile.ts` - Type definitions (432 lines)
- `src/core/sync/profile-manager.ts` - CRUD for profiles (463 lines)
- `src/core/sync/rate-limiter.ts` - Rate limiting logic (365 lines)
- `src/core/sync/project-context.ts` - Project management (379 lines)

**Client Libraries** (Profile-Based):
- `plugins/specweave-github/lib/github-client-v2.ts` - GitHub sync (466 lines)
- `plugins/specweave-jira/lib/jira-client-v2.ts` - JIRA sync (520 lines)
- `plugins/specweave-ado/lib/ado-client-v2.ts` - ADO sync (485 lines)

**UX Components**:
- `src/core/sync/time-range-selector.ts` - Interactive time range selection (295 lines)
- `src/core/sync/profile-selector.ts` - Interactive profile selection (230 lines)

**Migration**:
- `src/cli/commands/migrate-to-profiles.ts` - Automatic migration from V1 (425 lines)

### Common Commands

```bash
# Profile management
/specweave:sync-profile create
/specweave:sync-profile list
/specweave:sync-profile get <id>
/specweave:sync-profile update <id>
/specweave:sync-profile delete <id>

# Project management
/specweave:project create
/specweave:project list
/specweave:project link <project-id> <increment-id>
/specweave:project stats

# Syncing (GitHub example)
/specweave-github:sync <increment-id>
/specweave-github:sync <increment-id> --profile <id>
/specweave-github:sync <increment-id> --time-range 1M
/specweave-github:sync <increment-id> --dry-run

# Migration from V1
specweave migrate-to-profiles
```

### Migration from V1 (Single Project)

**Automatic**:
```bash
specweave migrate-to-profiles
```

**Output**:
```
‚úÖ Created GitHub profile: default-github
   Repository: anton-abyzov/specweave

‚úÖ Created default project context
   Name: specweave
   Default profile: default-github

üìä Migration Summary:
   Profiles created: 1
   Projects created: 1
```

### Documentation

**User Guide**: `.specweave/increments/0011-multi-project-sync/reports/USER-GUIDE-MULTI-PROJECT-SYNC.md`
**ADR**: `.specweave/docs/internal/architecture/adr/0016-multi-project-external-sync.md`
**Implementation Summary**: `.specweave/increments/0011-multi-project-sync/COMPLETE-IMPLEMENTATION.md`
**Command Docs**: `plugins/specweave-github/commands/specweave-github-sync.md`

---

## Key SpecWeave Principles (for Contributors)

### 1. Source of Truth Discipline
- `src/` is ALWAYS the source of truth
- `.claude/` is ALWAYS installed/generated (never edit directly)
- Keep root folder clean (use increment folders)

### 2. Documentation = Code
- All changes must update relevant documentation
- ADRs for architecture decisions
- RFCs for feature proposals
- Inline code comments for complex logic

### 3. Testing is Non-Negotiable
- E2E tests MANDATORY for UI features (Playwright)
- 80%+ coverage for critical paths
- Tests must tell the truth (no false positives)

### 4. Incremental Development
- Work in small, measurable increments
- Use SpecWeave's own workflow (`/specweave:increment`, `/specweave:do`, etc.)
- All work traces back to specs

### 5. Adapter-First Design
- Core framework must be tool-agnostic
- Tool-specific features in adapters only
- Plain Markdown + YAML = maximum portability

---

## Release Process

### Versioning Strategy

**IMPORTANT**: SpecWeave follows semantic versioning (semver), but version bumps are **MANUAL** and controlled:

**The Rules**:
- ‚úÖ **Patch version** (0.7.X) - Increment ONLY when explicitly requested by maintainer
- ‚úÖ **Minor version** (0.X.0) - Increment ONLY when maintainer says to
- ‚úÖ **Major version** (X.0.0) - Increment ONLY when maintainer says to
- ‚ùå **NEVER auto-increment** versions after each increment completion

**Why Manual Control?**
- Multiple increments may be part of the same release (e.g., 0.7.0 = increments 0006 + 0007 + 0008)
- Version bumps signal user-facing releases, not internal development progress
- Maintainer decides when features are ready to ship
- Prevents version number inflation (e.g., jumping from 0.7.0 to 0.12.0 in one day)

**When Completing Increments**:
```bash
# ‚ùå WRONG - Don't auto-bump version
git commit -m "feat: complete increment 0008"
npm version patch  # ‚ùå NO! Wait for maintainer approval

# ‚úÖ CORRECT - Just commit the work
git commit -m "feat: complete increment 0008"
# Version stays at 0.7.0 until maintainer says to bump
```

**When Maintainer Requests Version Bump**:
```bash
# Maintainer says: "Bump to 0.7.1"
npm version patch  # ‚úÖ Now bump
npm publish        # ‚úÖ And publish

# Maintainer says: "Bump to 0.8.0"
npm version minor  # ‚úÖ New minor version
npm publish
```

**Summary**: Complete increments ‚Üí commit code ‚Üí maintainer decides when to bump version and publish.

---

### Release Process (Automated via GitHub Actions)

**CRITICAL**: GitHub releases and NPM versions MUST ALWAYS be in sync!

**Automated Release Workflow** (`.github/workflows/release.yml`):

The release process is fully automated via GitHub Actions. To publish a new version:

1. **Update CHANGELOG.md** first (manually):
   ```bash
   vim CHANGELOG.md
   # Add new version section with release notes
   # Commit: git commit -m "docs: update changelog for v0.8.19"
   ```

2. **Trigger GitHub Actions Workflow**:
   - Go to: https://github.com/anton-abyzov/specweave/actions/workflows/release.yml
   - Click "Run workflow"
   - Select branch: `develop`
   - Enter version: e.g., `0.8.19`
   - Select version type: `patch`, `minor`, or `major`
   - Click "Run workflow"

3. **What the workflow does automatically**:
   - ‚úÖ Runs tests (`npm test`)
   - ‚úÖ Builds project (`npm run build`)
   - ‚úÖ Bumps version in `package.json`
   - ‚úÖ Verifies version matches input
   - ‚úÖ Extracts release notes from CHANGELOG.md
   - ‚úÖ Commits version bump
   - ‚úÖ Creates and pushes git tag (`v0.8.19`)
   - ‚úÖ **Publishes to NPM** (with provenance)
   - ‚úÖ **Creates GitHub Release** (with CHANGELOG notes)
   - ‚úÖ Notifies success/failure

**Result**: NPM package and GitHub release are created together atomically.

**Manual Release (Emergency Only)**:
```bash
# Only if GitHub Actions is down or fails
# 1. Update version
npm version patch|minor|major

# 2. Build and test
npm run build && npm test && npm run test:e2e

# 3. Publish to NPM
npm publish --provenance --access public

# 4. Create GitHub release
gh release create v$(node -p "require('./package.json').version") \
  --title "v$(node -p "require('./package.json').version")" \
  --notes-file /tmp/release-notes.md

# 5. Push tags
git push origin develop --tags
```

**Installation Methods**:
1. **NPM**: `npm install -g specweave`
2. **Script**: `curl -fsSL https://spec-weave.com/install.sh | bash`
3. **Manual**: Clone repo, `npm install`, `npm run build`

---

## Adapter System (Legacy)

**SpecWeave is Claude Code-first** - The framework is designed specifically for Claude Code's native capabilities.

**Primary Tool**:
- ‚úÖ **Claude Code** - Native support (slash commands, agents, skills, hooks, MCP)

**Legacy Multi-Tool Support** (may be removed):
- ‚ö†Ô∏è  Cursor (via `.cursorrules` + AGENTS.md compilation)
- ‚ö†Ô∏è  Generic (via AGENTS.md, for Copilot/ChatGPT/Gemini/etc.)

**Why Claude-First?**
The adapter system was originally designed to support multiple tools, but this added significant complexity without meaningful benefit. Claude Code provides:
- ‚úÖ **Native plugin marketplace** - No compilation needed
- ‚úÖ **Auto-activating skills** - No manual @ mentions
- ‚úÖ **Isolated agent contexts** - True role separation
- ‚úÖ **Pre/post lifecycle hooks** - Automated living docs sync
- ‚úÖ **MCP protocol** - Industry standard for context management

Other tools simply can't match these capabilities. The adapters remain in the codebase for now but are considered legacy and may be removed in a future version.

**See**: "Why Claude Code is Best-in-Class" section above for detailed comparison

---

## Common Tasks

### Adding Skills, Agents, or Commands

**All components go into plugins** (see "Plugins" section above for complete instructions).

**Quick reference**:
- **Core components**: `plugins/specweave/{skills|agents|commands|hooks}/`
- **Plugin components**: `plugins/specweave-{name}/{skills|agents|commands}/`
- **Tests**: `tests/integration/{component-name}/` or `tests/unit/`

**For detailed instructions**: See "Adding a New Plugin (Contributors)" section above

### Update Documentation

```bash
# Internal docs (architecture, ADRs, RFCs)
vim .specweave/docs/internal/architecture/hld-system.md

# Public docs (user-facing guides, can be published)
vim .specweave/docs/public/guides/user-guide.md
vim docs-site/docs/guides/getting-started.md

# Build docs site
cd docs-site && npm run build
```

### Translation Workflow (Multilingual Support)

**SpecWeave supports multilingual development** via two-phase post-generation translation (Increment 0006).

**Key Concept**: Users work in their native language (great UX), system auto-translates to English (maintainable docs).

**Two-Phase Translation Architecture**:

| Phase | Hook | What Gets Translated | When | Coverage |
|-------|------|---------------------|------|----------|
| **Phase 1** | post-increment-planning | Increment files + Living docs specs | After `/specweave:increment` | 80% of docs |
| **Phase 2** | post-task-completion | ADRs, HLDs, diagrams | After each task completion | 20% of docs |

**Workflow**:

```bash
# 1. User creates increment in Russian
/specweave:increment "–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é"

# 2. PM agent generates spec.md, plan.md, tasks.md in Russian (natural, user-friendly)

# 3. post-increment-planning hook fires automatically (PHASE 1)
#    Phase A: Translates increment files (spec.md, plan.md, tasks.md) to English
#    Phase B: Translates living docs specs to English (NEW!)
#             - .specweave/docs/internal/specs/spec-*.md
#             - .specweave/docs/internal/strategy/**/*.md
#    Cost: ~$0.02 total

# User sees:
# ‚úÖ Increment created
# üåê Detected Russian content. Translating increment files to English...
#   üìÑ spec.md... ‚úÖ
#   üìÑ plan.md... ‚úÖ
#   üìÑ tasks.md... ‚úÖ
# üåê Checking living docs for translation...
#   üìÑ Living docs detected: spec-0001-user-auth.md
#   ‚úÖ Translated 1 living docs file(s) to English
# ‚úÖ Translation complete!
#    Increment files: 3/3
#    Living docs: 1 file(s)
#    Estimated cost: ~$0.01-0.02 (using Haiku)

# 4. During implementation, architect creates ADRs in Russian

# 5. post-task-completion hook fires after each task (PHASE 2)
#    - Translates newly created ADRs to English
#    - Translates HLDs/diagrams to English
#    Cost: ~$0.01 per file

# Result: ALL documentation in English (100% coverage)
```

**Configuration** (`.specweave/config.json`):

```json
{
  "language": "ru",
  "translation": {
    "enabled": true,
    "autoTranslateInternalDocs": true,
    "autoTranslateLivingDocs": true,
    "keepFrameworkTerms": true,
    "keepTechnicalTerms": true,
    "translationModel": "haiku"
  }
}
```

**Key Settings**:
- `language`: Primary language (en, ru, es, zh, de, fr, ja, ko, pt)
- `autoTranslateInternalDocs`: Auto-translate increment files + living docs specs to English (default: true)
- `autoTranslateLivingDocs`: Auto-translate ADRs/HLDs after task completion (default: true)
- `translationModel`: Model to use (haiku/sonnet/opus, default: haiku)

**Supported Languages**:
- English (en)
- Russian (ru)
- Spanish (es)
- Chinese (zh)
- German (de)
- French (fr)
- Japanese (ja)
- Korean (ko)
- Portuguese (pt)

**Cost**: ~$0.02 per increment (5-7 files, Haiku model)

**Coverage**: 100% (no gaps! All living docs translated)

**Implementation Details**:
- Language detection: Heuristic-based (<1ms, zero cost)
- Code preservation: Never translates code blocks, inline code, or links
- Validation: Checks heading count, code block count, link count, YAML structure
- See: `.specweave/increments/0006-llm-native-i18n/reports/IMPLEMENTATION-COMPLETE.md`

**Testing Translation Utilities**:

```bash
# Run translation unit tests
npm test -- tests/unit/i18n/translation.test.ts

# Test result: 67/67 passing (100%)
```

**Files**:
- Utilities: `src/utils/translation.ts` (673 lines, 11 languages)
- CLI Script: `src/hooks/lib/translate-file.ts` (398 lines)
- Hook (Phase 1): `plugins/specweave/hooks/post-increment-planning.sh` (~420 lines)
- Hook (Phase 2): `src/hooks/lib/translate-living-docs.ts` (217 lines)
- Tests: `tests/unit/i18n/translation.test.ts` (705 lines, 67 tests)
- E2E Tests: `tests/e2e/i18n/living-docs-translation.spec.ts` (6 test cases)
- Schema: `src/core/schemas/specweave-config.schema.json`

**Migrating Existing Non-English Living Docs**:

For projects with existing non-English living docs, use the one-time migration script:

```bash
# One-time migration (translates all living docs to English)
bash scripts/migrate-living-docs-to-english.sh

# What it does:
# - Scans .specweave/docs/internal/ for non-English files
# - Translates each file to English (preserves code blocks, links, framework terms)
# - Skips files already in English
# - Non-blocking (continues even if some files fail)

# Estimated time: 1-2 minutes per 100 files
# Estimated cost: ~$0.01 per file (using Haiku)
```

**After migration**:
```bash
# Review translated files
git diff .specweave/docs/internal/

# Commit changes
git add . && git commit -m "docs: translate living docs to English"

# Future increments will auto-translate
/specweave:increment "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é"  # Auto-translates!
```

---

## Troubleshooting

**Skills not activating?**
1. Check plugin is installed: `/plugin list --installed`
2. Verify YAML frontmatter in `plugins/{plugin}/skills/{skill}/SKILL.md`
3. Restart Claude Code
4. Check description has clear trigger keywords

**Commands not working?**
1. Check plugin is installed: `/plugin list --installed`
2. Verify command exists: `plugins/{plugin}/commands/{command}.md`
3. Check YAML frontmatter
4. Restart Claude Code

**Tests failing?**
1. Run `npm run build` first
2. Check test output for specific errors
3. Verify test data in `tests/fixtures/`
4. Check Playwright browser install: `npx playwright install`

**Root folder polluted?**
1. Identify which increment created the files
2. Move to `.specweave/increments/####/reports/`
3. Update `.gitignore` if needed

---

## Getting Help

**Documentation**:
- User docs: https://spec-weave.com
- Contributor docs: `.specweave/docs/internal/`
- Architecture: `.specweave/docs/internal/architecture/`

**Community**:
- GitHub Issues: https://github.com/anton-abyzov/specweave/issues
- Discussions: https://github.com/anton-abyzov/specweave/discussions

**Current Increment**:
- Spec: `.specweave/increments/0002-core-enhancements/spec.md`
- Plan: `.specweave/increments/0002-core-enhancements/plan.md`
- Tasks: `.specweave/increments/0002-core-enhancements/tasks.md`

---

## Quick Reference

**Commands (for SpecWeave development)**:

**IMPORTANT**: All commands MUST use the `/specweave:*` namespace prefix to avoid conflicts with Claude Code's native commands.

*Primary commands*:
- `/specweave:increment "feature"` - Plan new increment
- `/specweave:do` - Execute tasks (smart resume)
- `/specweave:done 0002` - Close increment
- `/specweave:validate 0002` - Validate increment
- `/specweave:qa 0002` - Quality assessment with risk scoring
- `/specweave:status` - Show increment status overview
- `/specweave:progress` - Check current increment progress
- `/specweave:check-tests` - Validate test coverage (NEW format)

*State management (mostly automatic)*:
- `/specweave:pause 0002 --reason="..."` - Pause active increment
- `/specweave:resume 0002` - Resume paused increment
- `/specweave:abandon 0002 --reason="..."` - Abandon increment

*Documentation sync*:
- `/specweave:sync-docs update` - Sync living docs after implementation
- `/specweave:sync-tasks` - Sync tasks with completion status

*Other commands*:
- `/specweave:costs` - Show AI cost dashboard
- `/specweave:translate` - Translate content
- `/specweave:update-scope` - Log scope changes
- `/specweave:next` - Smart increment transition

**NO SHORTCUTS**: Do NOT use shortcuts like `/inc`, `/do`, `/pause`, `/resume` etc. They conflict with Claude Code's native commands and will break functionality.

**File naming**: All commands are `specweave-{name}.md` (e.g., `specweave-increment.md`)

**Build & Test**:
- `npm run build` - Compile TypeScript
- `npm test` - Run unit tests (includes skill tests in `tests/unit/`, `tests/integration/`)
- `npm run test:e2e` - Run Playwright E2E tests
- `npm run test:integration` - Run integration tests

**File Structure**:
- Source of truth: `src/` (TypeScript) and `plugins/` (skills/agents/commands)
- Marketplace: GLOBAL (via CLI, not per-project files)
- Increments: `.specweave/increments/`
- Internal Docs: `.specweave/docs/internal/` (strategy, architecture, ADRs)
- Public Docs: `.specweave/docs/public/` and `docs-site/` (user guides, API docs)
- Tests: `tests/` (unit, integration, E2E, skill tests)

---

**Remember**:
1. Edit source files in `src/`, not `.claude/`
2. Keep root folder clean (use increment folders)
3. Test before committing (E2E + unit + integration)
4. Update docs when structure changes
5. Follow increment-based workflow

**SpecWeave Documentation**: https://spec-weave.com
**Last Updated**: 2025-11-04
